{"ast":null,"code":"function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nimport React, { forwardRef, useCallback, useContext, useEffect, useRef, useState } from 'react';\nimport styled, { ThemeContext } from 'styled-components';\nimport { selectedStyle, setFocusWithoutScroll } from '../../utils';\nimport { defaultProps } from '../../default-props';\nimport { Box } from '../Box';\nimport { Button } from '../Button';\nimport { InfiniteScroll } from '../InfiniteScroll';\nimport { Keyboard } from '../Keyboard';\nimport { Text } from '../Text';\nimport { TextInput } from '../TextInput';\nimport { StyledContainer } from './StyledSelect';\nimport { applyKey } from './utils'; // position relative is so scroll can be managed correctly\n\nvar OptionsBox = styled.div.withConfig({\n  displayName: \"SelectContainer__OptionsBox\",\n  componentId: \"sc-1wi0ul8-0\"\n})([\"position:relative;scroll-behavior:smooth;overflow:auto;outline:none;\"]);\nvar SelectOption = styled(Button).withConfig({\n  displayName: \"SelectContainer__SelectOption\",\n  componentId: \"sc-1wi0ul8-1\"\n})([\"\", \" display:block;width:100%;\"], function (props) {\n  return props.selected && props.textComponent && selectedStyle;\n});\n\nvar ClearButton = function ClearButton(_ref) {\n  var clear = _ref.clear,\n      onClear = _ref.onClear,\n      name = _ref.name,\n      theme = _ref.theme,\n      setFocus = _ref.setFocus;\n  var label = clear.label,\n      position = clear.position;\n  var align = position !== 'bottom' ? 'start' : 'center';\n  var buttonLabel = label || \"Clear \" + (name || 'selection');\n  return /*#__PURE__*/React.createElement(Button, {\n    onClick: onClear,\n    onFocus: function onFocus() {\n      return setFocus(true);\n    },\n    onBlur: function onBlur() {\n      return setFocus(false);\n    }\n  }, /*#__PURE__*/React.createElement(Box, _extends({}, theme.select.clear.container, {\n    align: align\n  }), /*#__PURE__*/React.createElement(Text, theme.select.clear.text, buttonLabel)));\n};\n\nvar SelectContainer = /*#__PURE__*/forwardRef(function (_ref2, ref) {\n  var clear = _ref2.clear,\n      _ref2$children = _ref2.children,\n      children = _ref2$children === void 0 ? null : _ref2$children,\n      disabled = _ref2.disabled,\n      disabledKey = _ref2.disabledKey,\n      dropHeight = _ref2.dropHeight,\n      _ref2$emptySearchMess = _ref2.emptySearchMessage,\n      emptySearchMessage = _ref2$emptySearchMess === void 0 ? 'No matches found' : _ref2$emptySearchMess,\n      id = _ref2.id,\n      labelKey = _ref2.labelKey,\n      multiple = _ref2.multiple,\n      name = _ref2.name,\n      onChange = _ref2.onChange,\n      onKeyDown = _ref2.onKeyDown,\n      onMore = _ref2.onMore,\n      onSearch = _ref2.onSearch,\n      optionIndexesInValue = _ref2.optionIndexesInValue,\n      options = _ref2.options,\n      allOptions = _ref2.allOptions,\n      searchPlaceholder = _ref2.searchPlaceholder,\n      search = _ref2.search,\n      setSearch = _ref2.setSearch,\n      selected = _ref2.selected,\n      usingKeyboard = _ref2.usingKeyboard,\n      _ref2$value = _ref2.value,\n      value = _ref2$value === void 0 ? '' : _ref2$value,\n      valueKey = _ref2.valueKey,\n      _ref2$replace = _ref2.replace,\n      replace = _ref2$replace === void 0 ? true : _ref2$replace;\n  var theme = useContext(ThemeContext) || defaultProps.theme;\n\n  var _useState = useState(-1),\n      activeIndex = _useState[0],\n      setActiveIndex = _useState[1];\n\n  var _useState2 = useState(),\n      keyboardNavigation = _useState2[0],\n      setKeyboardNavigation = _useState2[1];\n\n  var _useState3 = useState(false),\n      focus = _useState3[0],\n      setFocus = _useState3[1];\n\n  var searchRef = useRef();\n  var optionsRef = useRef();\n  useEffect(function () {\n    var optionsNode = optionsRef.current;\n    if (optionsNode.children && optionsNode.children[activeIndex]) optionsNode.children[activeIndex].focus();\n  }, [activeIndex]); // adjust activeIndex when options change\n\n  useEffect(function () {\n    if (activeIndex === -1 && search && optionIndexesInValue.length) {\n      setActiveIndex(optionIndexesInValue[0]);\n    }\n  }, [activeIndex, optionIndexesInValue, search]); // set initial focus\n\n  useEffect(function () {\n    // need to wait for Drop to be ready\n    var timer = setTimeout(function () {\n      var optionsNode = optionsRef.current;\n\n      if (onSearch) {\n        var searchInput = searchRef.current;\n\n        if (searchInput && searchInput.focus) {\n          setFocusWithoutScroll(searchInput);\n        }\n      } else if (optionsNode && optionsNode.children && usingKeyboard) {\n        // if the user is navigating with the keyboard set the\n        // first child as the active index when the drop opens\n        setFocusWithoutScroll(optionsNode.children[0]);\n        setActiveIndex(0);\n      } else if (optionsNode) {\n        setFocusWithoutScroll(optionsNode);\n      }\n    }, 100);\n    return function () {\n      return clearTimeout(timer);\n    };\n  }, [onSearch, usingKeyboard]); // clear keyboardNavigation after a while\n\n  useEffect(function () {\n    if (keyboardNavigation) {\n      // 100ms was empirically determined\n      var timer = setTimeout(function () {\n        return setKeyboardNavigation(false);\n      }, 100);\n      return function () {\n        return clearTimeout(timer);\n      };\n    }\n\n    return undefined;\n  }, [keyboardNavigation]);\n  var optionLabel = useCallback(function (index) {\n    return applyKey(options[index], labelKey);\n  }, [labelKey, options]);\n  var optionValue = useCallback(function (index) {\n    return applyKey(options[index], valueKey);\n  }, [options, valueKey]);\n  var isDisabled = useCallback(function (index) {\n    var option = options[index];\n    var result;\n\n    if (disabledKey) {\n      result = applyKey(option, disabledKey);\n    } else if (Array.isArray(disabled)) {\n      if (typeof disabled[0] === 'number') {\n        result = disabled.indexOf(index) !== -1;\n      } else {\n        var optionVal = optionValue(index);\n        result = disabled.indexOf(optionVal) !== -1;\n      }\n    }\n\n    return result;\n  }, [disabled, disabledKey, options, optionValue]);\n  var isSelected = useCallback(function (index) {\n    var result;\n\n    if (selected) {\n      // deprecated in favor of value\n      result = selected.indexOf(index) !== -1;\n    } else {\n      var optionVal = optionValue(index);\n\n      if (Array.isArray(value)) {\n        if (value.length === 0) {\n          result = false;\n        } else if (typeof value[0] !== 'object') {\n          result = value.indexOf(optionVal) !== -1;\n        } else if (valueKey) {\n          result = value.some(function (valueItem) {\n            var valueValue = typeof valueKey === 'function' ? valueKey(valueItem) : valueItem[valueKey];\n            return valueValue === optionVal;\n          });\n        }\n      } else if (valueKey && typeof value === 'object') {\n        var valueValue = typeof valueKey === 'function' ? valueKey(value) : value[valueKey];\n        result = valueValue === optionVal;\n      } else {\n        result = value === optionVal;\n      }\n    }\n\n    return result;\n  }, [optionValue, selected, value, valueKey]);\n  var selectOption = useCallback(function (index) {\n    return function (event) {\n      if (onChange) {\n        var nextValue;\n        var nextSelected;\n\n        if (multiple) {\n          var nextOptionIndexesInValue = optionIndexesInValue.slice(0);\n          var allOptionsIndex = allOptions.indexOf(options[index]);\n          var valueIndex = optionIndexesInValue.indexOf(allOptionsIndex);\n\n          if (valueIndex === -1) {\n            nextOptionIndexesInValue.push(allOptionsIndex);\n          } else {\n            nextOptionIndexesInValue.splice(valueIndex, 1);\n          }\n\n          nextValue = nextOptionIndexesInValue.map(function (i) {\n            return valueKey && valueKey.reduce ? applyKey(allOptions[i], valueKey) : allOptions[i];\n          });\n          nextSelected = nextOptionIndexesInValue;\n        } else {\n          nextValue = valueKey && valueKey.reduce ? applyKey(options[index], valueKey) : options[index];\n          nextSelected = index;\n        }\n\n        onChange(event, {\n          option: options[index],\n          value: nextValue,\n          selected: nextSelected\n        });\n      }\n    };\n  }, [multiple, onChange, optionIndexesInValue, options, allOptions, valueKey]);\n  var onClear = useCallback(function (event) {\n    onChange(event, {\n      option: undefined,\n      value: '',\n      selected: ''\n    });\n  }, [onChange]);\n  var onNextOption = useCallback(function (event) {\n    event.preventDefault();\n    var nextActiveIndex = activeIndex + 1;\n\n    while (nextActiveIndex < options.length && isDisabled(nextActiveIndex)) {\n      nextActiveIndex += 1;\n    }\n\n    if (nextActiveIndex !== options.length) {\n      setActiveIndex(nextActiveIndex);\n      setKeyboardNavigation(true);\n    }\n  }, [activeIndex, isDisabled, options]);\n  var onPreviousOption = useCallback(function (event) {\n    event.preventDefault();\n    var nextActiveIndex = activeIndex - 1;\n\n    while (nextActiveIndex >= 0 && isDisabled(nextActiveIndex)) {\n      nextActiveIndex -= 1;\n    }\n\n    if (nextActiveIndex >= 0) {\n      setActiveIndex(nextActiveIndex);\n      setKeyboardNavigation(true);\n    }\n  }, [activeIndex, isDisabled]);\n  var onKeyDownOption = useCallback(function (event) {\n    if (!onSearch) {\n      var nextActiveIndex = options.findIndex(function (e, index) {\n        var label;\n\n        if (typeof e === 'object') {\n          label = e.label || applyKey(e, labelKey);\n        } else {\n          label = e;\n        }\n\n        return typeof label === 'string' && label.charAt(0).toLowerCase() === event.key.toLowerCase() && !isDisabled(index);\n      });\n\n      if (nextActiveIndex >= 0) {\n        event.preventDefault();\n        setActiveIndex(nextActiveIndex);\n        setKeyboardNavigation(true);\n      }\n    }\n\n    if (onKeyDown) {\n      onKeyDown(event);\n    }\n  }, [onKeyDown, options, isDisabled, onSearch, labelKey]);\n  var onActiveOption = useCallback(function (index) {\n    return function () {\n      if (!keyboardNavigation) setActiveIndex(index);\n    };\n  }, [keyboardNavigation]);\n  var onSelectOption = useCallback(function (event) {\n    if (activeIndex >= 0 && !focus) {\n      event.preventDefault(); // prevent submitting forms\n\n      selectOption(activeIndex)(event);\n    }\n  }, [activeIndex, selectOption, focus]);\n  var customSearchInput = theme.select.searchInput;\n  var SelectTextInput = customSearchInput || TextInput;\n  var selectOptionsStyle = theme.select.options ? _extends({}, theme.select.options.box, theme.select.options.container) : {};\n  return /*#__PURE__*/React.createElement(Keyboard, {\n    onEnter: onSelectOption,\n    onUp: onPreviousOption,\n    onDown: onNextOption,\n    onKeyDown: onKeyDownOption\n  }, /*#__PURE__*/React.createElement(StyledContainer, {\n    ref: ref,\n    as: Box,\n    id: id ? id + \"__select-drop\" : undefined,\n    dropHeight: dropHeight\n  }, onSearch && /*#__PURE__*/React.createElement(Box, {\n    pad: !customSearchInput ? 'xsmall' : undefined,\n    flex: false\n  }, /*#__PURE__*/React.createElement(SelectTextInput, {\n    focusIndicator: !customSearchInput,\n    size: \"small\",\n    ref: searchRef,\n    type: \"search\",\n    value: search || '',\n    placeholder: searchPlaceholder,\n    onChange: function onChange(event) {\n      var nextSearch = event.target.value;\n      setSearch(nextSearch);\n      setActiveIndex(-1);\n      onSearch(nextSearch);\n    }\n  })), clear && clear.position !== 'bottom' && value && /*#__PURE__*/React.createElement(ClearButton, {\n    clear: clear,\n    name: name,\n    onClear: onClear,\n    theme: theme,\n    setFocus: setFocus\n  }), /*#__PURE__*/React.createElement(OptionsBox, {\n    role: \"listbox\",\n    tabIndex: \"-1\",\n    ref: optionsRef,\n    \"aria-multiselectable\": multiple\n  }, options.length > 0 ? /*#__PURE__*/React.createElement(InfiniteScroll, {\n    items: options,\n    step: theme.select.step,\n    onMore: onMore,\n    replace: replace,\n    show: activeIndex !== -1 ? activeIndex : undefined\n  }, function (option, index, optionRef) {\n    var optionDisabled = isDisabled(index);\n    var optionSelected = isSelected(index);\n    var optionActive = activeIndex === index; // Determine whether the label is done as a child or\n    // as an option Button kind property.\n\n    var child;\n    var textComponent = false;\n\n    if (children) {\n      child = children(option, index, options, {\n        active: optionActive,\n        disabled: optionDisabled,\n        selected: optionSelected\n      });\n      if (typeof child === 'string' || child.props && child.props.children && typeof child.props.children === 'string') textComponent = true;\n    } else if (theme.select.options) {\n      child = /*#__PURE__*/React.createElement(Box, selectOptionsStyle, /*#__PURE__*/React.createElement(Text, theme.select.options.text, optionLabel(index)));\n      textComponent = true;\n    } // if we have a child, turn on plain, and hoverIndicator\n\n\n    return /*#__PURE__*/React.createElement(SelectOption // eslint-disable-next-line react/no-array-index-key\n    , {\n      key: index,\n      ref: optionRef,\n      tabIndex: optionSelected ? '0' : '-1',\n      role: \"option\",\n      \"aria-setsize\": options.length,\n      \"aria-posinset\": index + 1,\n      \"aria-selected\": optionSelected,\n      focusIndicator: false,\n      \"aria-disabled\": optionDisabled || undefined,\n      plain: !child ? undefined : true,\n      align: \"start\",\n      kind: !child ? 'option' : undefined,\n      hoverIndicator: !child ? undefined : 'background',\n      label: !child ? optionLabel(index) : undefined,\n      disabled: optionDisabled || undefined,\n      active: optionActive,\n      selected: optionSelected,\n      option: option,\n      onMouseOver: !optionDisabled ? onActiveOption(index) : undefined,\n      onClick: !optionDisabled ? selectOption(index) : undefined,\n      textComponent: textComponent\n    }, child);\n  }) : /*#__PURE__*/React.createElement(SelectOption, {\n    key: \"search_empty\",\n    tabIndex: \"-1\",\n    role: \"menuitem\",\n    hoverIndicator: \"background\",\n    disabled: true\n  }, /*#__PURE__*/React.createElement(Box, selectOptionsStyle, /*#__PURE__*/React.createElement(Text, theme.select.container.text, emptySearchMessage)))), clear && clear.position === 'bottom' && value && /*#__PURE__*/React.createElement(ClearButton, {\n    clear: clear,\n    name: name,\n    onClear: onClear,\n    theme: theme,\n    setFocus: setFocus\n  })));\n});\nexport { SelectContainer };","map":{"version":3,"sources":["C:/Personal-Portfolio/node_modules/grommet/es6/components/Select/SelectContainer.js"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","React","forwardRef","useCallback","useContext","useEffect","useRef","useState","styled","ThemeContext","selectedStyle","setFocusWithoutScroll","defaultProps","Box","Button","InfiniteScroll","Keyboard","Text","TextInput","StyledContainer","applyKey","OptionsBox","div","withConfig","displayName","componentId","SelectOption","props","selected","textComponent","ClearButton","_ref","clear","onClear","name","theme","setFocus","label","position","align","buttonLabel","createElement","onClick","onFocus","onBlur","select","container","text","SelectContainer","_ref2","ref","_ref2$children","children","disabled","disabledKey","dropHeight","_ref2$emptySearchMess","emptySearchMessage","id","labelKey","multiple","onChange","onKeyDown","onMore","onSearch","optionIndexesInValue","options","allOptions","searchPlaceholder","search","setSearch","usingKeyboard","_ref2$value","value","valueKey","_ref2$replace","replace","_useState","activeIndex","setActiveIndex","_useState2","keyboardNavigation","setKeyboardNavigation","_useState3","focus","searchRef","optionsRef","optionsNode","current","timer","setTimeout","searchInput","clearTimeout","undefined","optionLabel","index","optionValue","isDisabled","option","result","Array","isArray","indexOf","optionVal","isSelected","some","valueItem","valueValue","selectOption","event","nextValue","nextSelected","nextOptionIndexesInValue","slice","allOptionsIndex","valueIndex","push","splice","map","reduce","onNextOption","preventDefault","nextActiveIndex","onPreviousOption","onKeyDownOption","findIndex","e","charAt","toLowerCase","onActiveOption","onSelectOption","customSearchInput","SelectTextInput","selectOptionsStyle","box","onEnter","onUp","onDown","as","pad","flex","focusIndicator","size","type","placeholder","nextSearch","role","tabIndex","items","step","show","optionRef","optionDisabled","optionSelected","optionActive","child","active","plain","kind","hoverIndicator","onMouseOver"],"mappings":"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","sourcesContent":["function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React, { forwardRef, useCallback, useContext, useEffect, useRef, useState } from 'react';\nimport styled, { ThemeContext } from 'styled-components';\nimport { selectedStyle, setFocusWithoutScroll } from '../../utils';\nimport { defaultProps } from '../../default-props';\nimport { Box } from '../Box';\nimport { Button } from '../Button';\nimport { InfiniteScroll } from '../InfiniteScroll';\nimport { Keyboard } from '../Keyboard';\nimport { Text } from '../Text';\nimport { TextInput } from '../TextInput';\nimport { StyledContainer } from './StyledSelect';\nimport { applyKey } from './utils'; // position relative is so scroll can be managed correctly\n\nvar OptionsBox = styled.div.withConfig({\n  displayName: \"SelectContainer__OptionsBox\",\n  componentId: \"sc-1wi0ul8-0\"\n})([\"position:relative;scroll-behavior:smooth;overflow:auto;outline:none;\"]);\nvar SelectOption = styled(Button).withConfig({\n  displayName: \"SelectContainer__SelectOption\",\n  componentId: \"sc-1wi0ul8-1\"\n})([\"\", \" display:block;width:100%;\"], function (props) {\n  return props.selected && props.textComponent && selectedStyle;\n});\n\nvar ClearButton = function ClearButton(_ref) {\n  var clear = _ref.clear,\n      onClear = _ref.onClear,\n      name = _ref.name,\n      theme = _ref.theme,\n      setFocus = _ref.setFocus;\n  var label = clear.label,\n      position = clear.position;\n  var align = position !== 'bottom' ? 'start' : 'center';\n  var buttonLabel = label || \"Clear \" + (name || 'selection');\n  return /*#__PURE__*/React.createElement(Button, {\n    onClick: onClear,\n    onFocus: function onFocus() {\n      return setFocus(true);\n    },\n    onBlur: function onBlur() {\n      return setFocus(false);\n    }\n  }, /*#__PURE__*/React.createElement(Box, _extends({}, theme.select.clear.container, {\n    align: align\n  }), /*#__PURE__*/React.createElement(Text, theme.select.clear.text, buttonLabel)));\n};\n\nvar SelectContainer = /*#__PURE__*/forwardRef(function (_ref2, ref) {\n  var clear = _ref2.clear,\n      _ref2$children = _ref2.children,\n      children = _ref2$children === void 0 ? null : _ref2$children,\n      disabled = _ref2.disabled,\n      disabledKey = _ref2.disabledKey,\n      dropHeight = _ref2.dropHeight,\n      _ref2$emptySearchMess = _ref2.emptySearchMessage,\n      emptySearchMessage = _ref2$emptySearchMess === void 0 ? 'No matches found' : _ref2$emptySearchMess,\n      id = _ref2.id,\n      labelKey = _ref2.labelKey,\n      multiple = _ref2.multiple,\n      name = _ref2.name,\n      onChange = _ref2.onChange,\n      onKeyDown = _ref2.onKeyDown,\n      onMore = _ref2.onMore,\n      onSearch = _ref2.onSearch,\n      optionIndexesInValue = _ref2.optionIndexesInValue,\n      options = _ref2.options,\n      allOptions = _ref2.allOptions,\n      searchPlaceholder = _ref2.searchPlaceholder,\n      search = _ref2.search,\n      setSearch = _ref2.setSearch,\n      selected = _ref2.selected,\n      usingKeyboard = _ref2.usingKeyboard,\n      _ref2$value = _ref2.value,\n      value = _ref2$value === void 0 ? '' : _ref2$value,\n      valueKey = _ref2.valueKey,\n      _ref2$replace = _ref2.replace,\n      replace = _ref2$replace === void 0 ? true : _ref2$replace;\n  var theme = useContext(ThemeContext) || defaultProps.theme;\n\n  var _useState = useState(-1),\n      activeIndex = _useState[0],\n      setActiveIndex = _useState[1];\n\n  var _useState2 = useState(),\n      keyboardNavigation = _useState2[0],\n      setKeyboardNavigation = _useState2[1];\n\n  var _useState3 = useState(false),\n      focus = _useState3[0],\n      setFocus = _useState3[1];\n\n  var searchRef = useRef();\n  var optionsRef = useRef();\n  useEffect(function () {\n    var optionsNode = optionsRef.current;\n    if (optionsNode.children && optionsNode.children[activeIndex]) optionsNode.children[activeIndex].focus();\n  }, [activeIndex]); // adjust activeIndex when options change\n\n  useEffect(function () {\n    if (activeIndex === -1 && search && optionIndexesInValue.length) {\n      setActiveIndex(optionIndexesInValue[0]);\n    }\n  }, [activeIndex, optionIndexesInValue, search]); // set initial focus\n\n  useEffect(function () {\n    // need to wait for Drop to be ready\n    var timer = setTimeout(function () {\n      var optionsNode = optionsRef.current;\n\n      if (onSearch) {\n        var searchInput = searchRef.current;\n\n        if (searchInput && searchInput.focus) {\n          setFocusWithoutScroll(searchInput);\n        }\n      } else if (optionsNode && optionsNode.children && usingKeyboard) {\n        // if the user is navigating with the keyboard set the\n        // first child as the active index when the drop opens\n        setFocusWithoutScroll(optionsNode.children[0]);\n        setActiveIndex(0);\n      } else if (optionsNode) {\n        setFocusWithoutScroll(optionsNode);\n      }\n    }, 100);\n    return function () {\n      return clearTimeout(timer);\n    };\n  }, [onSearch, usingKeyboard]); // clear keyboardNavigation after a while\n\n  useEffect(function () {\n    if (keyboardNavigation) {\n      // 100ms was empirically determined\n      var timer = setTimeout(function () {\n        return setKeyboardNavigation(false);\n      }, 100);\n      return function () {\n        return clearTimeout(timer);\n      };\n    }\n\n    return undefined;\n  }, [keyboardNavigation]);\n  var optionLabel = useCallback(function (index) {\n    return applyKey(options[index], labelKey);\n  }, [labelKey, options]);\n  var optionValue = useCallback(function (index) {\n    return applyKey(options[index], valueKey);\n  }, [options, valueKey]);\n  var isDisabled = useCallback(function (index) {\n    var option = options[index];\n    var result;\n\n    if (disabledKey) {\n      result = applyKey(option, disabledKey);\n    } else if (Array.isArray(disabled)) {\n      if (typeof disabled[0] === 'number') {\n        result = disabled.indexOf(index) !== -1;\n      } else {\n        var optionVal = optionValue(index);\n        result = disabled.indexOf(optionVal) !== -1;\n      }\n    }\n\n    return result;\n  }, [disabled, disabledKey, options, optionValue]);\n  var isSelected = useCallback(function (index) {\n    var result;\n\n    if (selected) {\n      // deprecated in favor of value\n      result = selected.indexOf(index) !== -1;\n    } else {\n      var optionVal = optionValue(index);\n\n      if (Array.isArray(value)) {\n        if (value.length === 0) {\n          result = false;\n        } else if (typeof value[0] !== 'object') {\n          result = value.indexOf(optionVal) !== -1;\n        } else if (valueKey) {\n          result = value.some(function (valueItem) {\n            var valueValue = typeof valueKey === 'function' ? valueKey(valueItem) : valueItem[valueKey];\n            return valueValue === optionVal;\n          });\n        }\n      } else if (valueKey && typeof value === 'object') {\n        var valueValue = typeof valueKey === 'function' ? valueKey(value) : value[valueKey];\n        result = valueValue === optionVal;\n      } else {\n        result = value === optionVal;\n      }\n    }\n\n    return result;\n  }, [optionValue, selected, value, valueKey]);\n  var selectOption = useCallback(function (index) {\n    return function (event) {\n      if (onChange) {\n        var nextValue;\n        var nextSelected;\n\n        if (multiple) {\n          var nextOptionIndexesInValue = optionIndexesInValue.slice(0);\n          var allOptionsIndex = allOptions.indexOf(options[index]);\n          var valueIndex = optionIndexesInValue.indexOf(allOptionsIndex);\n\n          if (valueIndex === -1) {\n            nextOptionIndexesInValue.push(allOptionsIndex);\n          } else {\n            nextOptionIndexesInValue.splice(valueIndex, 1);\n          }\n\n          nextValue = nextOptionIndexesInValue.map(function (i) {\n            return valueKey && valueKey.reduce ? applyKey(allOptions[i], valueKey) : allOptions[i];\n          });\n          nextSelected = nextOptionIndexesInValue;\n        } else {\n          nextValue = valueKey && valueKey.reduce ? applyKey(options[index], valueKey) : options[index];\n          nextSelected = index;\n        }\n\n        onChange(event, {\n          option: options[index],\n          value: nextValue,\n          selected: nextSelected\n        });\n      }\n    };\n  }, [multiple, onChange, optionIndexesInValue, options, allOptions, valueKey]);\n  var onClear = useCallback(function (event) {\n    onChange(event, {\n      option: undefined,\n      value: '',\n      selected: ''\n    });\n  }, [onChange]);\n  var onNextOption = useCallback(function (event) {\n    event.preventDefault();\n    var nextActiveIndex = activeIndex + 1;\n\n    while (nextActiveIndex < options.length && isDisabled(nextActiveIndex)) {\n      nextActiveIndex += 1;\n    }\n\n    if (nextActiveIndex !== options.length) {\n      setActiveIndex(nextActiveIndex);\n      setKeyboardNavigation(true);\n    }\n  }, [activeIndex, isDisabled, options]);\n  var onPreviousOption = useCallback(function (event) {\n    event.preventDefault();\n    var nextActiveIndex = activeIndex - 1;\n\n    while (nextActiveIndex >= 0 && isDisabled(nextActiveIndex)) {\n      nextActiveIndex -= 1;\n    }\n\n    if (nextActiveIndex >= 0) {\n      setActiveIndex(nextActiveIndex);\n      setKeyboardNavigation(true);\n    }\n  }, [activeIndex, isDisabled]);\n  var onKeyDownOption = useCallback(function (event) {\n    if (!onSearch) {\n      var nextActiveIndex = options.findIndex(function (e, index) {\n        var label;\n\n        if (typeof e === 'object') {\n          label = e.label || applyKey(e, labelKey);\n        } else {\n          label = e;\n        }\n\n        return typeof label === 'string' && label.charAt(0).toLowerCase() === event.key.toLowerCase() && !isDisabled(index);\n      });\n\n      if (nextActiveIndex >= 0) {\n        event.preventDefault();\n        setActiveIndex(nextActiveIndex);\n        setKeyboardNavigation(true);\n      }\n    }\n\n    if (onKeyDown) {\n      onKeyDown(event);\n    }\n  }, [onKeyDown, options, isDisabled, onSearch, labelKey]);\n  var onActiveOption = useCallback(function (index) {\n    return function () {\n      if (!keyboardNavigation) setActiveIndex(index);\n    };\n  }, [keyboardNavigation]);\n  var onSelectOption = useCallback(function (event) {\n    if (activeIndex >= 0 && !focus) {\n      event.preventDefault(); // prevent submitting forms\n\n      selectOption(activeIndex)(event);\n    }\n  }, [activeIndex, selectOption, focus]);\n  var customSearchInput = theme.select.searchInput;\n  var SelectTextInput = customSearchInput || TextInput;\n  var selectOptionsStyle = theme.select.options ? _extends({}, theme.select.options.box, theme.select.options.container) : {};\n  return /*#__PURE__*/React.createElement(Keyboard, {\n    onEnter: onSelectOption,\n    onUp: onPreviousOption,\n    onDown: onNextOption,\n    onKeyDown: onKeyDownOption\n  }, /*#__PURE__*/React.createElement(StyledContainer, {\n    ref: ref,\n    as: Box,\n    id: id ? id + \"__select-drop\" : undefined,\n    dropHeight: dropHeight\n  }, onSearch && /*#__PURE__*/React.createElement(Box, {\n    pad: !customSearchInput ? 'xsmall' : undefined,\n    flex: false\n  }, /*#__PURE__*/React.createElement(SelectTextInput, {\n    focusIndicator: !customSearchInput,\n    size: \"small\",\n    ref: searchRef,\n    type: \"search\",\n    value: search || '',\n    placeholder: searchPlaceholder,\n    onChange: function onChange(event) {\n      var nextSearch = event.target.value;\n      setSearch(nextSearch);\n      setActiveIndex(-1);\n      onSearch(nextSearch);\n    }\n  })), clear && clear.position !== 'bottom' && value && /*#__PURE__*/React.createElement(ClearButton, {\n    clear: clear,\n    name: name,\n    onClear: onClear,\n    theme: theme,\n    setFocus: setFocus\n  }), /*#__PURE__*/React.createElement(OptionsBox, {\n    role: \"listbox\",\n    tabIndex: \"-1\",\n    ref: optionsRef,\n    \"aria-multiselectable\": multiple\n  }, options.length > 0 ? /*#__PURE__*/React.createElement(InfiniteScroll, {\n    items: options,\n    step: theme.select.step,\n    onMore: onMore,\n    replace: replace,\n    show: activeIndex !== -1 ? activeIndex : undefined\n  }, function (option, index, optionRef) {\n    var optionDisabled = isDisabled(index);\n    var optionSelected = isSelected(index);\n    var optionActive = activeIndex === index; // Determine whether the label is done as a child or\n    // as an option Button kind property.\n\n    var child;\n    var textComponent = false;\n\n    if (children) {\n      child = children(option, index, options, {\n        active: optionActive,\n        disabled: optionDisabled,\n        selected: optionSelected\n      });\n      if (typeof child === 'string' || child.props && child.props.children && typeof child.props.children === 'string') textComponent = true;\n    } else if (theme.select.options) {\n      child = /*#__PURE__*/React.createElement(Box, selectOptionsStyle, /*#__PURE__*/React.createElement(Text, theme.select.options.text, optionLabel(index)));\n      textComponent = true;\n    } // if we have a child, turn on plain, and hoverIndicator\n\n\n    return /*#__PURE__*/React.createElement(SelectOption // eslint-disable-next-line react/no-array-index-key\n    , {\n      key: index,\n      ref: optionRef,\n      tabIndex: optionSelected ? '0' : '-1',\n      role: \"option\",\n      \"aria-setsize\": options.length,\n      \"aria-posinset\": index + 1,\n      \"aria-selected\": optionSelected,\n      focusIndicator: false,\n      \"aria-disabled\": optionDisabled || undefined,\n      plain: !child ? undefined : true,\n      align: \"start\",\n      kind: !child ? 'option' : undefined,\n      hoverIndicator: !child ? undefined : 'background',\n      label: !child ? optionLabel(index) : undefined,\n      disabled: optionDisabled || undefined,\n      active: optionActive,\n      selected: optionSelected,\n      option: option,\n      onMouseOver: !optionDisabled ? onActiveOption(index) : undefined,\n      onClick: !optionDisabled ? selectOption(index) : undefined,\n      textComponent: textComponent\n    }, child);\n  }) : /*#__PURE__*/React.createElement(SelectOption, {\n    key: \"search_empty\",\n    tabIndex: \"-1\",\n    role: \"menuitem\",\n    hoverIndicator: \"background\",\n    disabled: true\n  }, /*#__PURE__*/React.createElement(Box, selectOptionsStyle, /*#__PURE__*/React.createElement(Text, theme.select.container.text, emptySearchMessage)))), clear && clear.position === 'bottom' && value && /*#__PURE__*/React.createElement(ClearButton, {\n    clear: clear,\n    name: name,\n    onClear: onClear,\n    theme: theme,\n    setFocus: setFocus\n  })));\n});\nexport { SelectContainer };"]},"metadata":{},"sourceType":"module"}