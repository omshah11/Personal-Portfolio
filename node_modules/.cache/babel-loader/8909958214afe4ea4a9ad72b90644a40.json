{"ast":null,"code":"var _excluded = [\"alignSelf\", \"autoPlay\", \"children\", \"controls\", \"gridArea\", \"loop\", \"margin\", \"messages\", \"mute\", \"onDurationChange\", \"onEnded\", \"onPause\", \"onPlay\", \"onTimeUpdate\", \"onVolumeChange\"];\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nimport React, { forwardRef, useCallback, useContext, useEffect, useMemo, useRef, useState } from 'react';\nimport { ThemeContext } from 'styled-components';\nimport { useLayoutEffect } from '../../utils/use-isomorphic-layout-effect';\nimport { defaultProps } from '../../default-props';\nimport { Box } from '../Box';\nimport { Button } from '../Button';\nimport { Menu } from '../Menu';\nimport { Meter } from '../Meter';\nimport { Stack } from '../Stack';\nimport { Text } from '../Text';\nimport { containsFocus, useForwardedRef } from '../../utils';\nimport { StyledVideo, StyledVideoContainer, StyledVideoControls, StyledVideoScrubber } from './StyledVideo';\nimport { MessageContext } from '../../contexts/MessageContext';\nimport { VideoPropTypes } from './propTypes'; // Split the volume control into 6 segments. Empirically determined.\n\nvar VOLUME_STEP = 0.166667;\n\nvar formatTime = function formatTime(time) {\n  var minutes = Math.round(time / 60);\n\n  if (minutes < 10) {\n    minutes = \"0\" + minutes;\n  }\n\n  var seconds = Math.round(time) % 60;\n\n  if (seconds < 10) {\n    seconds = \"0\" + seconds;\n  }\n\n  return minutes + \":\" + seconds;\n};\n\nvar Video = /*#__PURE__*/forwardRef(function (_ref, ref) {\n  var alignSelf = _ref.alignSelf,\n      autoPlay = _ref.autoPlay,\n      children = _ref.children,\n      controlsProp = _ref.controls,\n      gridArea = _ref.gridArea,\n      loop = _ref.loop,\n      margin = _ref.margin,\n      messages = _ref.messages,\n      mute = _ref.mute,\n      _onDurationChange = _ref.onDurationChange,\n      _onEnded = _ref.onEnded,\n      _onPause = _ref.onPause,\n      _onPlay = _ref.onPlay,\n      _onTimeUpdate = _ref.onTimeUpdate,\n      _onVolumeChange = _ref.onVolumeChange,\n      rest = _objectWithoutPropertiesLoose(_ref, _excluded);\n\n  var theme = useContext(ThemeContext) || defaultProps.theme;\n\n  var _useContext = useContext(MessageContext),\n      format = _useContext.format;\n\n  var _useState = useState([]),\n      captions = _useState[0],\n      setCaptions = _useState[1];\n\n  var _useState2 = useState(),\n      currentTime = _useState2[0],\n      setCurrentTime = _useState2[1];\n\n  var _useState3 = useState(),\n      duration = _useState3[0],\n      setDuration = _useState3[1];\n\n  var _useState4 = useState(),\n      percentagePlayed = _useState4[0],\n      setPercentagePlayed = _useState4[1];\n\n  var _useState5 = useState(false),\n      playing = _useState5[0],\n      setPlaying = _useState5[1];\n\n  var _useState6 = useState(),\n      scrubTime = _useState6[0],\n      setScrubTime = _useState6[1];\n\n  var _useState7 = useState(),\n      volume = _useState7[0],\n      setVolume = _useState7[1];\n\n  var _useState8 = useState(false),\n      hasPlayed = _useState8[0],\n      setHasPlayed = _useState8[1];\n\n  var _useState9 = useState(),\n      interacting = _useState9[0],\n      setInteracting = _useState9[1];\n\n  var _useState10 = useState(),\n      height = _useState10[0],\n      setHeight = _useState10[1];\n\n  var _useState11 = useState(),\n      width = _useState11[0],\n      setWidth = _useState11[1];\n\n  var containerRef = useRef();\n  var scrubberRef = useRef();\n  var videoRef = useForwardedRef(ref);\n  var controls = useMemo(function () {\n    var result;\n\n    if (typeof controlsProp === 'string' || typeof controlsProp === 'boolean') {\n      result = {\n        items: ['volume', 'fullScreen'],\n        position: controlsProp\n      };\n    } else {\n      result = {\n        items: (controlsProp == null ? void 0 : controlsProp.items) || ['volume', 'fullScreen'],\n        position: (controlsProp == null ? void 0 : controlsProp.position) || 'over'\n      };\n    }\n\n    return result;\n  }, [controlsProp]); // mute if needed\n\n  useEffect(function () {\n    var video = videoRef.current;\n    if (video && mute) video.muted = true;\n  }, [mute, videoRef]); // when the video is first rendered, set state from it where needed\n\n  useEffect(function () {\n    var video = videoRef.current;\n\n    if (video) {\n      // hide all captioning to start with\n      var textTracks = video.textTracks;\n\n      for (var i = 0; i < textTracks.length; i += 1) {\n        textTracks[i].mode = 'hidden';\n      }\n\n      setCurrentTime(video.currentTime);\n      setPercentagePlayed(video.currentTime / video.duration * 100);\n      setVolume(videoRef.current.volume);\n    }\n  }, [videoRef]); // turn off interacting after a while\n\n  useEffect(function () {\n    var timer = setTimeout(function () {\n      if (interacting && !containsFocus(containerRef.current)) {\n        setInteracting(false);\n      }\n    }, 3000);\n    return function () {\n      return clearTimeout(timer);\n    };\n  }, [interacting]);\n  useLayoutEffect(function () {\n    var video = videoRef.current;\n\n    if (video) {\n      if (video.videoHeight) {\n        // set the size based on the video aspect ratio\n        var rect = video.getBoundingClientRect();\n        var ratio = rect.width / rect.height;\n        var videoRatio = video.videoWidth / video.videoHeight;\n\n        if (videoRatio > ratio) {\n          var nextHeight = rect.width / videoRatio;\n\n          if (nextHeight !== height) {\n            setHeight(nextHeight);\n            setWidth(undefined);\n          }\n        } else {\n          var nextWidth = rect.height * videoRatio;\n\n          if (nextWidth !== width) {\n            setHeight(undefined);\n            setWidth(nextWidth);\n          }\n        }\n      } // remember the state of the text tracks for subsequent rendering\n\n\n      var textTracks = video.textTracks;\n\n      if (textTracks.length > 0) {\n        if (textTracks.length === 1) {\n          var active = textTracks[0].mode === 'showing';\n\n          if (!captions || !captions[0] || captions[0].active !== active) {\n            setCaptions([{\n              active: active\n            }]);\n          }\n        } else {\n          var nextCaptions = [];\n          var set = false;\n\n          for (var i = 0; i < textTracks.length; i += 1) {\n            var track = textTracks[i];\n\n            var _active = track.mode === 'showing';\n\n            nextCaptions.push({\n              label: track.label,\n              active: _active\n            });\n\n            if (!captions || !captions[i] || captions[i].active !== _active) {\n              set = true;\n            }\n          }\n\n          if (set) {\n            setCaptions(nextCaptions);\n          }\n        }\n      }\n    }\n  }, [captions, height, videoRef, width]);\n  var play = useCallback(function () {\n    return videoRef.current.play();\n  }, [videoRef]);\n  var pause = useCallback(function () {\n    return videoRef.current.pause();\n  }, [videoRef]);\n  var scrub = useCallback(function (event) {\n    if (scrubberRef.current) {\n      var scrubberRect = scrubberRef.current.getBoundingClientRect();\n      var percent = (event.clientX - scrubberRect.left) / scrubberRect.width;\n      setScrubTime(duration * percent);\n    }\n  }, [duration]);\n  var seek = useCallback(function (event) {\n    if (scrubberRef.current) {\n      var scrubberRect = scrubberRef.current.getBoundingClientRect();\n      var percent = (event.clientX - scrubberRect.left) / scrubberRect.width;\n      if (duration) videoRef.current.currentTime = duration * percent;\n    }\n  }, [duration, videoRef]);\n  var louder = useCallback(function () {\n    videoRef.current.volume += VOLUME_STEP;\n  }, [videoRef]);\n  var quieter = useCallback(function () {\n    videoRef.current.volume -= VOLUME_STEP;\n  }, [videoRef]);\n\n  var showCaptions = function showCaptions(index) {\n    var textTracks = videoRef.current.textTracks;\n\n    for (var i = 0; i < textTracks.length; i += 1) {\n      textTracks[i].mode = i === index ? 'showing' : 'hidden';\n    }\n  };\n\n  var fullscreen = useCallback(function () {\n    var video = videoRef.current;\n\n    if (video.requestFullscreen) {\n      video.requestFullscreen();\n    } else if (video.msRequestFullscreen) {\n      video.msRequestFullscreen();\n    } else if (video.mozRequestFullScreen) {\n      video.mozRequestFullScreen();\n    } else if (video.webkitRequestFullscreen) {\n      video.webkitRequestFullscreen();\n    } else {\n      console.warn(\"This browser doesn't support fullscreen.\");\n    }\n  }, [videoRef]);\n  var controlsElement;\n\n  if (controls != null && controls.position) {\n    var _controls$items;\n\n    var over = controls.position === 'over';\n    var background = over ? theme.video.controls && theme.video.controls.background || {\n      color: 'background-back',\n      opacity: 'strong',\n      dark: true\n    } : undefined;\n    var iconColor = over && (theme.video.icons.color || 'text');\n    var formattedTime = formatTime(scrubTime || currentTime || duration);\n    var Icons = {\n      ClosedCaption: theme.video.icons.closedCaption,\n      Configure: theme.video.icons.configure,\n      FullScreen: theme.video.icons.fullScreen,\n      Pause: theme.video.icons.pause,\n      Play: theme.video.icons.play,\n      ReduceVolume: theme.video.icons.reduceVolume,\n      Volume: theme.video.icons.volume\n    };\n    var captionControls = captions.map(function (caption) {\n      return {\n        icon: caption.label ? undefined : /*#__PURE__*/React.createElement(Icons.ClosedCaption, {\n          color: iconColor\n        }),\n        label: caption.label,\n        active: caption.active,\n        onClick: function onClick() {\n          return showCaptions(caption.active ? -1 : 0);\n        }\n      };\n    });\n    var volumeControls = ['volume', 'reduceVolume'].map(function (control) {\n      return {\n        icon: control === 'volume' ? /*#__PURE__*/React.createElement(Icons.Volume, {\n          color: iconColor\n        }) : /*#__PURE__*/React.createElement(Icons.ReduceVolume, {\n          color: iconColor\n        }),\n        a11yTitle: format({\n          id: control === 'volume' ? 'video.volumeUp' : 'video.volumeDown',\n          messages: messages\n        }),\n        onClick: function onClick() {\n          if (volume <= 1 - VOLUME_STEP && control === 'volume') {\n            return louder();\n          }\n\n          if (volume >= VOLUME_STEP && control === 'reduceVolume') {\n            return quieter();\n          }\n\n          return undefined;\n        },\n        close: false\n      };\n    });\n    var buttonProps = {\n      captions: captionControls,\n      volume: volumeControls,\n      fullScreen: {\n        icon: /*#__PURE__*/React.createElement(Icons.FullScreen, {\n          color: iconColor\n        }),\n        a11yTitle: format({\n          id: 'video.fullScreen',\n          messages: messages\n        }),\n        onClick: fullscreen\n      },\n      pause: {\n        icon: /*#__PURE__*/React.createElement(Icons.Pause, {\n          color: iconColor\n        }),\n        a11yTitle: format({\n          id: 'video.pauseButton',\n          messages: messages\n        }),\n        onClick: playing ? pause : play\n      },\n      play: {\n        icon: /*#__PURE__*/React.createElement(Icons.Play, {\n          color: iconColor\n        }),\n        a11yTitle: format({\n          id: 'video.playButton',\n          messages: messages\n        }),\n        onClick: playing ? pause : play\n      }\n    };\n    var controlsMenuItems = [];\n    (_controls$items = controls.items) == null ? void 0 : _controls$items.map(function (item) {\n      if (item === 'volume') {\n        volumeControls.map(function (control) {\n          return controlsMenuItems.push(control);\n        });\n        return undefined;\n      }\n\n      if (typeof item === 'string') return controlsMenuItems.push(buttonProps[item]);\n      return controlsMenuItems.push(item);\n    });\n    controlsElement = /*#__PURE__*/React.createElement(StyledVideoControls, {\n      over: over,\n      active: !hasPlayed || controls.position === 'below' || over && interacting,\n      onBlur: function onBlur() {\n        if (!containsFocus(containerRef.current)) setInteracting(false);\n      }\n    }, /*#__PURE__*/React.createElement(Box, {\n      direction: \"row\",\n      align: \"center\",\n      justify: \"between\",\n      background: background\n    }, /*#__PURE__*/React.createElement(Button, {\n      icon: playing ? /*#__PURE__*/React.createElement(Icons.Pause, {\n        color: iconColor,\n        a11yTitle: format({\n          id: 'video.pauseButton',\n          messages: messages\n        })\n      }) : /*#__PURE__*/React.createElement(Icons.Play, {\n        color: iconColor,\n        a11yTitle: format({\n          id: 'video.playButton',\n          messages: messages\n        })\n      }),\n      hoverIndicator: \"background\",\n      onClick: playing ? pause : play\n    }), /*#__PURE__*/React.createElement(Box, {\n      direction: \"row\",\n      align: \"center\",\n      flex: true\n    }, /*#__PURE__*/React.createElement(Box, {\n      flex: true\n    }, /*#__PURE__*/React.createElement(Stack, null, /*#__PURE__*/React.createElement(Meter, {\n      \"aria-label\": format({\n        id: 'video.progressMeter',\n        messages: messages\n      }),\n      background: over ? theme.video.scrubber && theme.video.scrubber.track && theme.video.scrubber.track.color || 'dark-3' : undefined,\n      size: \"full\",\n      thickness: \"small\",\n      values: [{\n        value: percentagePlayed || 0\n      }]\n    }), /*#__PURE__*/React.createElement(StyledVideoScrubber, {\n      \"aria-label\": format({\n        id: 'video.scrubber',\n        messages: messages\n      }),\n      ref: scrubberRef,\n      tabIndex: 0,\n      role: \"button\",\n      value: scrubTime ? Math.round(scrubTime / duration * 100) : undefined,\n      onMouseMove: scrub,\n      onMouseLeave: function onMouseLeave() {\n        return setScrubTime(undefined);\n      },\n      onClick: seek\n    }))), /*#__PURE__*/React.createElement(Box, {\n      pad: {\n        horizontal: 'small'\n      }\n    }, /*#__PURE__*/React.createElement(Text, {\n      margin: \"none\"\n    }, formattedTime))), /*#__PURE__*/React.createElement(Menu, {\n      icon: /*#__PURE__*/React.createElement(Icons.Configure, {\n        color: iconColor\n      }),\n      dropAlign: {\n        bottom: 'top',\n        right: 'right'\n      },\n      dropBackground: background,\n      messages: {\n        openMenu: format({\n          id: 'video.openMenu',\n          messages: messages\n        }),\n        closeMenu: format({\n          id: 'video.closeMenu',\n          messages: messages\n        })\n      },\n      items: [].concat(controlsMenuItems)\n    })));\n  }\n\n  var mouseEventListeners;\n\n  if ((controls == null ? void 0 : controls.position) === 'over') {\n    mouseEventListeners = {\n      onMouseEnter: function onMouseEnter() {\n        return setInteracting(true);\n      },\n      onMouseMove: function onMouseMove() {\n        return setInteracting(true);\n      },\n      onTouchStart: function onTouchStart() {\n        return setInteracting(true);\n      }\n    };\n  }\n\n  var style;\n\n  if (rest.fit === 'contain' && (controls == null ? void 0 : controls.position) === 'over') {\n    // constrain the size to fit the aspect ratio so the controls\n    // overlap correctly\n    if (width) {\n      style = {\n        width: width\n      };\n    } else if (height) {\n      style = {\n        height: height\n      };\n    }\n  }\n\n  return /*#__PURE__*/React.createElement(StyledVideoContainer, _extends({\n    ref: containerRef\n  }, mouseEventListeners, {\n    alignSelf: alignSelf,\n    gridArea: gridArea,\n    margin: margin,\n    style: style\n  }), /*#__PURE__*/React.createElement(StyledVideo, _extends({}, rest, {\n    ref: videoRef,\n    onDurationChange: function onDurationChange(event) {\n      var video = videoRef.current;\n      setDuration(video.duration);\n      setPercentagePlayed(video.currentTime / video.duration * 100);\n      if (_onDurationChange) _onDurationChange(event);\n    },\n    onEnded: function onEnded(event) {\n      setPlaying(false);\n      if (_onEnded) _onEnded(event);\n    },\n    onPause: function onPause(event) {\n      setPlaying(false);\n      if (_onPause) _onPause(event);\n    },\n    onPlay: function onPlay(event) {\n      setPlaying(true);\n      setHasPlayed(true);\n      if (_onPlay) _onPlay(event);\n    },\n    onTimeUpdate: function onTimeUpdate(event) {\n      var video = videoRef.current;\n      setCurrentTime(video.currentTime);\n      setPercentagePlayed(video.currentTime / video.duration * 100);\n      if (_onTimeUpdate) _onTimeUpdate(event);\n    },\n    onVolumeChange: function onVolumeChange(event) {\n      setVolume(videoRef.current.volume);\n      if (_onVolumeChange) _onVolumeChange(event);\n    },\n    autoPlay: autoPlay || false,\n    loop: loop || false\n  }), children), controlsElement);\n});\nVideo.defaultProps = {};\nVideo.displayName = 'Video';\nVideo.propTypes = VideoPropTypes;\nexport { Video };","map":{"version":3,"sources":["C:/Personal-Portfolio/node_modules/grommet/es6/components/Video/Video.js"],"names":["_excluded","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","_objectWithoutPropertiesLoose","excluded","sourceKeys","keys","indexOf","React","forwardRef","useCallback","useContext","useEffect","useMemo","useRef","useState","ThemeContext","useLayoutEffect","defaultProps","Box","Button","Menu","Meter","Stack","Text","containsFocus","useForwardedRef","StyledVideo","StyledVideoContainer","StyledVideoControls","StyledVideoScrubber","MessageContext","VideoPropTypes","VOLUME_STEP","formatTime","time","minutes","Math","round","seconds","Video","_ref","ref","alignSelf","autoPlay","children","controlsProp","controls","gridArea","loop","margin","messages","mute","_onDurationChange","onDurationChange","_onEnded","onEnded","_onPause","onPause","_onPlay","onPlay","_onTimeUpdate","onTimeUpdate","_onVolumeChange","onVolumeChange","rest","theme","_useContext","format","_useState","captions","setCaptions","_useState2","currentTime","setCurrentTime","_useState3","duration","setDuration","_useState4","percentagePlayed","setPercentagePlayed","_useState5","playing","setPlaying","_useState6","scrubTime","setScrubTime","_useState7","volume","setVolume","_useState8","hasPlayed","setHasPlayed","_useState9","interacting","setInteracting","_useState10","height","setHeight","_useState11","width","setWidth","containerRef","scrubberRef","videoRef","result","items","position","video","current","muted","textTracks","mode","timer","setTimeout","clearTimeout","videoHeight","rect","getBoundingClientRect","ratio","videoRatio","videoWidth","nextHeight","undefined","nextWidth","active","nextCaptions","set","track","_active","push","label","play","pause","scrub","event","scrubberRect","percent","clientX","left","seek","louder","quieter","showCaptions","index","fullscreen","requestFullscreen","msRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","console","warn","controlsElement","_controls$items","over","background","color","opacity","dark","iconColor","icons","formattedTime","Icons","ClosedCaption","closedCaption","Configure","configure","FullScreen","fullScreen","Pause","Play","ReduceVolume","reduceVolume","Volume","captionControls","map","caption","icon","createElement","onClick","volumeControls","control","a11yTitle","id","close","buttonProps","controlsMenuItems","item","onBlur","direction","align","justify","hoverIndicator","flex","scrubber","size","thickness","values","value","tabIndex","role","onMouseMove","onMouseLeave","pad","horizontal","dropAlign","bottom","right","dropBackground","openMenu","closeMenu","concat","mouseEventListeners","onMouseEnter","onTouchStart","style","fit","displayName","propTypes"],"mappings":"AAAA,IAAIA,SAAS,GAAG,CAAC,WAAD,EAAc,UAAd,EAA0B,UAA1B,EAAsC,UAAtC,EAAkD,UAAlD,EAA8D,MAA9D,EAAsE,QAAtE,EAAgF,UAAhF,EAA4F,MAA5F,EAAoG,kBAApG,EAAwH,SAAxH,EAAmI,SAAnI,EAA8I,QAA9I,EAAwJ,cAAxJ,EAAwK,gBAAxK,CAAhB;;AAEA,SAASC,QAAT,GAAoB;AAAEA,EAAAA,QAAQ,GAAGC,MAAM,CAACC,MAAP,IAAiB,UAAUC,MAAV,EAAkB;AAAE,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGC,SAAS,CAACC,MAA9B,EAAsCF,CAAC,EAAvC,EAA2C;AAAE,UAAIG,MAAM,GAAGF,SAAS,CAACD,CAAD,CAAtB;;AAA2B,WAAK,IAAII,GAAT,IAAgBD,MAAhB,EAAwB;AAAE,YAAIN,MAAM,CAACQ,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCJ,MAArC,EAA6CC,GAA7C,CAAJ,EAAuD;AAAEL,UAAAA,MAAM,CAACK,GAAD,CAAN,GAAcD,MAAM,CAACC,GAAD,CAApB;AAA4B;AAAE;AAAE;;AAAC,WAAOL,MAAP;AAAgB,GAA5P;;AAA8P,SAAOH,QAAQ,CAACY,KAAT,CAAe,IAAf,EAAqBP,SAArB,CAAP;AAAyC;;AAE7T,SAASQ,6BAAT,CAAuCN,MAAvC,EAA+CO,QAA/C,EAAyD;AAAE,MAAIP,MAAM,IAAI,IAAd,EAAoB,OAAO,EAAP;AAAW,MAAIJ,MAAM,GAAG,EAAb;AAAiB,MAAIY,UAAU,GAAGd,MAAM,CAACe,IAAP,CAAYT,MAAZ,CAAjB;AAAsC,MAAIC,GAAJ,EAASJ,CAAT;;AAAY,OAAKA,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGW,UAAU,CAACT,MAA3B,EAAmCF,CAAC,EAApC,EAAwC;AAAEI,IAAAA,GAAG,GAAGO,UAAU,CAACX,CAAD,CAAhB;AAAqB,QAAIU,QAAQ,CAACG,OAAT,CAAiBT,GAAjB,KAAyB,CAA7B,EAAgC;AAAUL,IAAAA,MAAM,CAACK,GAAD,CAAN,GAAcD,MAAM,CAACC,GAAD,CAApB;AAA4B;;AAAC,SAAOL,MAAP;AAAgB;;AAEnT,OAAOe,KAAP,IAAgBC,UAAhB,EAA4BC,WAA5B,EAAyCC,UAAzC,EAAqDC,SAArD,EAAgEC,OAAhE,EAAyEC,MAAzE,EAAiFC,QAAjF,QAAiG,OAAjG;AACA,SAASC,YAAT,QAA6B,mBAA7B;AACA,SAASC,eAAT,QAAgC,0CAAhC;AACA,SAASC,YAAT,QAA6B,qBAA7B;AACA,SAASC,GAAT,QAAoB,QAApB;AACA,SAASC,MAAT,QAAuB,WAAvB;AACA,SAASC,IAAT,QAAqB,SAArB;AACA,SAASC,KAAT,QAAsB,UAAtB;AACA,SAASC,KAAT,QAAsB,UAAtB;AACA,SAASC,IAAT,QAAqB,SAArB;AACA,SAASC,aAAT,EAAwBC,eAAxB,QAA+C,aAA/C;AACA,SAASC,WAAT,EAAsBC,oBAAtB,EAA4CC,mBAA5C,EAAiEC,mBAAjE,QAA4F,eAA5F;AACA,SAASC,cAAT,QAA+B,+BAA/B;AACA,SAASC,cAAT,QAA+B,aAA/B,C,CAA8C;;AAE9C,IAAIC,WAAW,GAAG,QAAlB;;AAEA,IAAIC,UAAU,GAAG,SAASA,UAAT,CAAoBC,IAApB,EAA0B;AACzC,MAAIC,OAAO,GAAGC,IAAI,CAACC,KAAL,CAAWH,IAAI,GAAG,EAAlB,CAAd;;AAEA,MAAIC,OAAO,GAAG,EAAd,EAAkB;AAChBA,IAAAA,OAAO,GAAG,MAAMA,OAAhB;AACD;;AAED,MAAIG,OAAO,GAAGF,IAAI,CAACC,KAAL,CAAWH,IAAX,IAAmB,EAAjC;;AAEA,MAAII,OAAO,GAAG,EAAd,EAAkB;AAChBA,IAAAA,OAAO,GAAG,MAAMA,OAAhB;AACD;;AAED,SAAOH,OAAO,GAAG,GAAV,GAAgBG,OAAvB;AACD,CAdD;;AAgBA,IAAIC,KAAK,GAAG,aAAa/B,UAAU,CAAC,UAAUgC,IAAV,EAAgBC,GAAhB,EAAqB;AACvD,MAAIC,SAAS,GAAGF,IAAI,CAACE,SAArB;AAAA,MACIC,QAAQ,GAAGH,IAAI,CAACG,QADpB;AAAA,MAEIC,QAAQ,GAAGJ,IAAI,CAACI,QAFpB;AAAA,MAGIC,YAAY,GAAGL,IAAI,CAACM,QAHxB;AAAA,MAIIC,QAAQ,GAAGP,IAAI,CAACO,QAJpB;AAAA,MAKIC,IAAI,GAAGR,IAAI,CAACQ,IALhB;AAAA,MAMIC,MAAM,GAAGT,IAAI,CAACS,MANlB;AAAA,MAOIC,QAAQ,GAAGV,IAAI,CAACU,QAPpB;AAAA,MAQIC,IAAI,GAAGX,IAAI,CAACW,IARhB;AAAA,MASIC,iBAAiB,GAAGZ,IAAI,CAACa,gBAT7B;AAAA,MAUIC,QAAQ,GAAGd,IAAI,CAACe,OAVpB;AAAA,MAWIC,QAAQ,GAAGhB,IAAI,CAACiB,OAXpB;AAAA,MAYIC,OAAO,GAAGlB,IAAI,CAACmB,MAZnB;AAAA,MAaIC,aAAa,GAAGpB,IAAI,CAACqB,YAbzB;AAAA,MAcIC,eAAe,GAAGtB,IAAI,CAACuB,cAd3B;AAAA,MAeIC,IAAI,GAAG9D,6BAA6B,CAACsC,IAAD,EAAOpD,SAAP,CAfxC;;AAiBA,MAAI6E,KAAK,GAAGvD,UAAU,CAACK,YAAD,CAAV,IAA4BE,YAAY,CAACgD,KAArD;;AAEA,MAAIC,WAAW,GAAGxD,UAAU,CAACoB,cAAD,CAA5B;AAAA,MACIqC,MAAM,GAAGD,WAAW,CAACC,MADzB;;AAGA,MAAIC,SAAS,GAAGtD,QAAQ,CAAC,EAAD,CAAxB;AAAA,MACIuD,QAAQ,GAAGD,SAAS,CAAC,CAAD,CADxB;AAAA,MAEIE,WAAW,GAAGF,SAAS,CAAC,CAAD,CAF3B;;AAIA,MAAIG,UAAU,GAAGzD,QAAQ,EAAzB;AAAA,MACI0D,WAAW,GAAGD,UAAU,CAAC,CAAD,CAD5B;AAAA,MAEIE,cAAc,GAAGF,UAAU,CAAC,CAAD,CAF/B;;AAIA,MAAIG,UAAU,GAAG5D,QAAQ,EAAzB;AAAA,MACI6D,QAAQ,GAAGD,UAAU,CAAC,CAAD,CADzB;AAAA,MAEIE,WAAW,GAAGF,UAAU,CAAC,CAAD,CAF5B;;AAIA,MAAIG,UAAU,GAAG/D,QAAQ,EAAzB;AAAA,MACIgE,gBAAgB,GAAGD,UAAU,CAAC,CAAD,CADjC;AAAA,MAEIE,mBAAmB,GAAGF,UAAU,CAAC,CAAD,CAFpC;;AAIA,MAAIG,UAAU,GAAGlE,QAAQ,CAAC,KAAD,CAAzB;AAAA,MACImE,OAAO,GAAGD,UAAU,CAAC,CAAD,CADxB;AAAA,MAEIE,UAAU,GAAGF,UAAU,CAAC,CAAD,CAF3B;;AAIA,MAAIG,UAAU,GAAGrE,QAAQ,EAAzB;AAAA,MACIsE,SAAS,GAAGD,UAAU,CAAC,CAAD,CAD1B;AAAA,MAEIE,YAAY,GAAGF,UAAU,CAAC,CAAD,CAF7B;;AAIA,MAAIG,UAAU,GAAGxE,QAAQ,EAAzB;AAAA,MACIyE,MAAM,GAAGD,UAAU,CAAC,CAAD,CADvB;AAAA,MAEIE,SAAS,GAAGF,UAAU,CAAC,CAAD,CAF1B;;AAIA,MAAIG,UAAU,GAAG3E,QAAQ,CAAC,KAAD,CAAzB;AAAA,MACI4E,SAAS,GAAGD,UAAU,CAAC,CAAD,CAD1B;AAAA,MAEIE,YAAY,GAAGF,UAAU,CAAC,CAAD,CAF7B;;AAIA,MAAIG,UAAU,GAAG9E,QAAQ,EAAzB;AAAA,MACI+E,WAAW,GAAGD,UAAU,CAAC,CAAD,CAD5B;AAAA,MAEIE,cAAc,GAAGF,UAAU,CAAC,CAAD,CAF/B;;AAIA,MAAIG,WAAW,GAAGjF,QAAQ,EAA1B;AAAA,MACIkF,MAAM,GAAGD,WAAW,CAAC,CAAD,CADxB;AAAA,MAEIE,SAAS,GAAGF,WAAW,CAAC,CAAD,CAF3B;;AAIA,MAAIG,WAAW,GAAGpF,QAAQ,EAA1B;AAAA,MACIqF,KAAK,GAAGD,WAAW,CAAC,CAAD,CADvB;AAAA,MAEIE,QAAQ,GAAGF,WAAW,CAAC,CAAD,CAF1B;;AAIA,MAAIG,YAAY,GAAGxF,MAAM,EAAzB;AACA,MAAIyF,WAAW,GAAGzF,MAAM,EAAxB;AACA,MAAI0F,QAAQ,GAAG9E,eAAe,CAACgB,GAAD,CAA9B;AACA,MAAIK,QAAQ,GAAGlC,OAAO,CAAC,YAAY;AACjC,QAAI4F,MAAJ;;AAEA,QAAI,OAAO3D,YAAP,KAAwB,QAAxB,IAAoC,OAAOA,YAAP,KAAwB,SAAhE,EAA2E;AACzE2D,MAAAA,MAAM,GAAG;AACPC,QAAAA,KAAK,EAAE,CAAC,QAAD,EAAW,YAAX,CADA;AAEPC,QAAAA,QAAQ,EAAE7D;AAFH,OAAT;AAID,KALD,MAKO;AACL2D,MAAAA,MAAM,GAAG;AACPC,QAAAA,KAAK,EAAE,CAAC5D,YAAY,IAAI,IAAhB,GAAuB,KAAK,CAA5B,GAAgCA,YAAY,CAAC4D,KAA9C,KAAwD,CAAC,QAAD,EAAW,YAAX,CADxD;AAEPC,QAAAA,QAAQ,EAAE,CAAC7D,YAAY,IAAI,IAAhB,GAAuB,KAAK,CAA5B,GAAgCA,YAAY,CAAC6D,QAA9C,KAA2D;AAF9D,OAAT;AAID;;AAED,WAAOF,MAAP;AACD,GAhBqB,EAgBnB,CAAC3D,YAAD,CAhBmB,CAAtB,CAtEuD,CAsFnC;;AAEpBlC,EAAAA,SAAS,CAAC,YAAY;AACpB,QAAIgG,KAAK,GAAGJ,QAAQ,CAACK,OAArB;AACA,QAAID,KAAK,IAAIxD,IAAb,EAAmBwD,KAAK,CAACE,KAAN,GAAc,IAAd;AACpB,GAHQ,EAGN,CAAC1D,IAAD,EAAOoD,QAAP,CAHM,CAAT,CAxFuD,CA2FjC;;AAEtB5F,EAAAA,SAAS,CAAC,YAAY;AACpB,QAAIgG,KAAK,GAAGJ,QAAQ,CAACK,OAArB;;AAEA,QAAID,KAAJ,EAAW;AACT;AACA,UAAIG,UAAU,GAAGH,KAAK,CAACG,UAAvB;;AAEA,WAAK,IAAIrH,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGqH,UAAU,CAACnH,MAA/B,EAAuCF,CAAC,IAAI,CAA5C,EAA+C;AAC7CqH,QAAAA,UAAU,CAACrH,CAAD,CAAV,CAAcsH,IAAd,GAAqB,QAArB;AACD;;AAEDtC,MAAAA,cAAc,CAACkC,KAAK,CAACnC,WAAP,CAAd;AACAO,MAAAA,mBAAmB,CAAC4B,KAAK,CAACnC,WAAN,GAAoBmC,KAAK,CAAChC,QAA1B,GAAqC,GAAtC,CAAnB;AACAa,MAAAA,SAAS,CAACe,QAAQ,CAACK,OAAT,CAAiBrB,MAAlB,CAAT;AACD;AACF,GAfQ,EAeN,CAACgB,QAAD,CAfM,CAAT,CA7FuD,CA4GvC;;AAEhB5F,EAAAA,SAAS,CAAC,YAAY;AACpB,QAAIqG,KAAK,GAAGC,UAAU,CAAC,YAAY;AACjC,UAAIpB,WAAW,IAAI,CAACrE,aAAa,CAAC6E,YAAY,CAACO,OAAd,CAAjC,EAAyD;AACvDd,QAAAA,cAAc,CAAC,KAAD,CAAd;AACD;AACF,KAJqB,EAInB,IAJmB,CAAtB;AAKA,WAAO,YAAY;AACjB,aAAOoB,YAAY,CAACF,KAAD,CAAnB;AACD,KAFD;AAGD,GATQ,EASN,CAACnB,WAAD,CATM,CAAT;AAUA7E,EAAAA,eAAe,CAAC,YAAY;AAC1B,QAAI2F,KAAK,GAAGJ,QAAQ,CAACK,OAArB;;AAEA,QAAID,KAAJ,EAAW;AACT,UAAIA,KAAK,CAACQ,WAAV,EAAuB;AACrB;AACA,YAAIC,IAAI,GAAGT,KAAK,CAACU,qBAAN,EAAX;AACA,YAAIC,KAAK,GAAGF,IAAI,CAACjB,KAAL,GAAaiB,IAAI,CAACpB,MAA9B;AACA,YAAIuB,UAAU,GAAGZ,KAAK,CAACa,UAAN,GAAmBb,KAAK,CAACQ,WAA1C;;AAEA,YAAII,UAAU,GAAGD,KAAjB,EAAwB;AACtB,cAAIG,UAAU,GAAGL,IAAI,CAACjB,KAAL,GAAaoB,UAA9B;;AAEA,cAAIE,UAAU,KAAKzB,MAAnB,EAA2B;AACzBC,YAAAA,SAAS,CAACwB,UAAD,CAAT;AACArB,YAAAA,QAAQ,CAACsB,SAAD,CAAR;AACD;AACF,SAPD,MAOO;AACL,cAAIC,SAAS,GAAGP,IAAI,CAACpB,MAAL,GAAcuB,UAA9B;;AAEA,cAAII,SAAS,KAAKxB,KAAlB,EAAyB;AACvBF,YAAAA,SAAS,CAACyB,SAAD,CAAT;AACAtB,YAAAA,QAAQ,CAACuB,SAAD,CAAR;AACD;AACF;AACF,OAtBQ,CAsBP;;;AAGF,UAAIb,UAAU,GAAGH,KAAK,CAACG,UAAvB;;AAEA,UAAIA,UAAU,CAACnH,MAAX,GAAoB,CAAxB,EAA2B;AACzB,YAAImH,UAAU,CAACnH,MAAX,KAAsB,CAA1B,EAA6B;AAC3B,cAAIiI,MAAM,GAAGd,UAAU,CAAC,CAAD,CAAV,CAAcC,IAAd,KAAuB,SAApC;;AAEA,cAAI,CAAC1C,QAAD,IAAa,CAACA,QAAQ,CAAC,CAAD,CAAtB,IAA6BA,QAAQ,CAAC,CAAD,CAAR,CAAYuD,MAAZ,KAAuBA,MAAxD,EAAgE;AAC9DtD,YAAAA,WAAW,CAAC,CAAC;AACXsD,cAAAA,MAAM,EAAEA;AADG,aAAD,CAAD,CAAX;AAGD;AACF,SARD,MAQO;AACL,cAAIC,YAAY,GAAG,EAAnB;AACA,cAAIC,GAAG,GAAG,KAAV;;AAEA,eAAK,IAAIrI,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGqH,UAAU,CAACnH,MAA/B,EAAuCF,CAAC,IAAI,CAA5C,EAA+C;AAC7C,gBAAIsI,KAAK,GAAGjB,UAAU,CAACrH,CAAD,CAAtB;;AAEA,gBAAIuI,OAAO,GAAGD,KAAK,CAAChB,IAAN,KAAe,SAA7B;;AAEAc,YAAAA,YAAY,CAACI,IAAb,CAAkB;AAChBC,cAAAA,KAAK,EAAEH,KAAK,CAACG,KADG;AAEhBN,cAAAA,MAAM,EAAEI;AAFQ,aAAlB;;AAKA,gBAAI,CAAC3D,QAAD,IAAa,CAACA,QAAQ,CAAC5E,CAAD,CAAtB,IAA6B4E,QAAQ,CAAC5E,CAAD,CAAR,CAAYmI,MAAZ,KAAuBI,OAAxD,EAAiE;AAC/DF,cAAAA,GAAG,GAAG,IAAN;AACD;AACF;;AAED,cAAIA,GAAJ,EAAS;AACPxD,YAAAA,WAAW,CAACuD,YAAD,CAAX;AACD;AACF;AACF;AACF;AACF,GAhEc,EAgEZ,CAACxD,QAAD,EAAW2B,MAAX,EAAmBO,QAAnB,EAA6BJ,KAA7B,CAhEY,CAAf;AAiEA,MAAIgC,IAAI,GAAG1H,WAAW,CAAC,YAAY;AACjC,WAAO8F,QAAQ,CAACK,OAAT,CAAiBuB,IAAjB,EAAP;AACD,GAFqB,EAEnB,CAAC5B,QAAD,CAFmB,CAAtB;AAGA,MAAI6B,KAAK,GAAG3H,WAAW,CAAC,YAAY;AAClC,WAAO8F,QAAQ,CAACK,OAAT,CAAiBwB,KAAjB,EAAP;AACD,GAFsB,EAEpB,CAAC7B,QAAD,CAFoB,CAAvB;AAGA,MAAI8B,KAAK,GAAG5H,WAAW,CAAC,UAAU6H,KAAV,EAAiB;AACvC,QAAIhC,WAAW,CAACM,OAAhB,EAAyB;AACvB,UAAI2B,YAAY,GAAGjC,WAAW,CAACM,OAAZ,CAAoBS,qBAApB,EAAnB;AACA,UAAImB,OAAO,GAAG,CAACF,KAAK,CAACG,OAAN,GAAgBF,YAAY,CAACG,IAA9B,IAAsCH,YAAY,CAACpC,KAAjE;AACAd,MAAAA,YAAY,CAACV,QAAQ,GAAG6D,OAAZ,CAAZ;AACD;AACF,GANsB,EAMpB,CAAC7D,QAAD,CANoB,CAAvB;AAOA,MAAIgE,IAAI,GAAGlI,WAAW,CAAC,UAAU6H,KAAV,EAAiB;AACtC,QAAIhC,WAAW,CAACM,OAAhB,EAAyB;AACvB,UAAI2B,YAAY,GAAGjC,WAAW,CAACM,OAAZ,CAAoBS,qBAApB,EAAnB;AACA,UAAImB,OAAO,GAAG,CAACF,KAAK,CAACG,OAAN,GAAgBF,YAAY,CAACG,IAA9B,IAAsCH,YAAY,CAACpC,KAAjE;AACA,UAAIxB,QAAJ,EAAc4B,QAAQ,CAACK,OAAT,CAAiBpC,WAAjB,GAA+BG,QAAQ,GAAG6D,OAA1C;AACf;AACF,GANqB,EAMnB,CAAC7D,QAAD,EAAW4B,QAAX,CANmB,CAAtB;AAOA,MAAIqC,MAAM,GAAGnI,WAAW,CAAC,YAAY;AACnC8F,IAAAA,QAAQ,CAACK,OAAT,CAAiBrB,MAAjB,IAA2BvD,WAA3B;AACD,GAFuB,EAErB,CAACuE,QAAD,CAFqB,CAAxB;AAGA,MAAIsC,OAAO,GAAGpI,WAAW,CAAC,YAAY;AACpC8F,IAAAA,QAAQ,CAACK,OAAT,CAAiBrB,MAAjB,IAA2BvD,WAA3B;AACD,GAFwB,EAEtB,CAACuE,QAAD,CAFsB,CAAzB;;AAIA,MAAIuC,YAAY,GAAG,SAASA,YAAT,CAAsBC,KAAtB,EAA6B;AAC9C,QAAIjC,UAAU,GAAGP,QAAQ,CAACK,OAAT,CAAiBE,UAAlC;;AAEA,SAAK,IAAIrH,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGqH,UAAU,CAACnH,MAA/B,EAAuCF,CAAC,IAAI,CAA5C,EAA+C;AAC7CqH,MAAAA,UAAU,CAACrH,CAAD,CAAV,CAAcsH,IAAd,GAAqBtH,CAAC,KAAKsJ,KAAN,GAAc,SAAd,GAA0B,QAA/C;AACD;AACF,GAND;;AAQA,MAAIC,UAAU,GAAGvI,WAAW,CAAC,YAAY;AACvC,QAAIkG,KAAK,GAAGJ,QAAQ,CAACK,OAArB;;AAEA,QAAID,KAAK,CAACsC,iBAAV,EAA6B;AAC3BtC,MAAAA,KAAK,CAACsC,iBAAN;AACD,KAFD,MAEO,IAAItC,KAAK,CAACuC,mBAAV,EAA+B;AACpCvC,MAAAA,KAAK,CAACuC,mBAAN;AACD,KAFM,MAEA,IAAIvC,KAAK,CAACwC,oBAAV,EAAgC;AACrCxC,MAAAA,KAAK,CAACwC,oBAAN;AACD,KAFM,MAEA,IAAIxC,KAAK,CAACyC,uBAAV,EAAmC;AACxCzC,MAAAA,KAAK,CAACyC,uBAAN;AACD,KAFM,MAEA;AACLC,MAAAA,OAAO,CAACC,IAAR,CAAa,0CAAb;AACD;AACF,GAd2B,EAczB,CAAC/C,QAAD,CAdyB,CAA5B;AAeA,MAAIgD,eAAJ;;AAEA,MAAIzG,QAAQ,IAAI,IAAZ,IAAoBA,QAAQ,CAAC4D,QAAjC,EAA2C;AACzC,QAAI8C,eAAJ;;AAEA,QAAIC,IAAI,GAAG3G,QAAQ,CAAC4D,QAAT,KAAsB,MAAjC;AACA,QAAIgD,UAAU,GAAGD,IAAI,GAAGxF,KAAK,CAAC0C,KAAN,CAAY7D,QAAZ,IAAwBmB,KAAK,CAAC0C,KAAN,CAAY7D,QAAZ,CAAqB4G,UAA7C,IAA2D;AACjFC,MAAAA,KAAK,EAAE,iBAD0E;AAEjFC,MAAAA,OAAO,EAAE,QAFwE;AAGjFC,MAAAA,IAAI,EAAE;AAH2E,KAA9D,GAIjBnC,SAJJ;AAKA,QAAIoC,SAAS,GAAGL,IAAI,KAAKxF,KAAK,CAAC0C,KAAN,CAAYoD,KAAZ,CAAkBJ,KAAlB,IAA2B,MAAhC,CAApB;AACA,QAAIK,aAAa,GAAG/H,UAAU,CAACmD,SAAS,IAAIZ,WAAb,IAA4BG,QAA7B,CAA9B;AACA,QAAIsF,KAAK,GAAG;AACVC,MAAAA,aAAa,EAAEjG,KAAK,CAAC0C,KAAN,CAAYoD,KAAZ,CAAkBI,aADvB;AAEVC,MAAAA,SAAS,EAAEnG,KAAK,CAAC0C,KAAN,CAAYoD,KAAZ,CAAkBM,SAFnB;AAGVC,MAAAA,UAAU,EAAErG,KAAK,CAAC0C,KAAN,CAAYoD,KAAZ,CAAkBQ,UAHpB;AAIVC,MAAAA,KAAK,EAAEvG,KAAK,CAAC0C,KAAN,CAAYoD,KAAZ,CAAkB3B,KAJf;AAKVqC,MAAAA,IAAI,EAAExG,KAAK,CAAC0C,KAAN,CAAYoD,KAAZ,CAAkB5B,IALd;AAMVuC,MAAAA,YAAY,EAAEzG,KAAK,CAAC0C,KAAN,CAAYoD,KAAZ,CAAkBY,YANtB;AAOVC,MAAAA,MAAM,EAAE3G,KAAK,CAAC0C,KAAN,CAAYoD,KAAZ,CAAkBxE;AAPhB,KAAZ;AASA,QAAIsF,eAAe,GAAGxG,QAAQ,CAACyG,GAAT,CAAa,UAAUC,OAAV,EAAmB;AACpD,aAAO;AACLC,QAAAA,IAAI,EAAED,OAAO,CAAC7C,KAAR,GAAgBR,SAAhB,GAA4B,aAAanH,KAAK,CAAC0K,aAAN,CAAoBhB,KAAK,CAACC,aAA1B,EAAyC;AACtFP,UAAAA,KAAK,EAAEG;AAD+E,SAAzC,CAD1C;AAIL5B,QAAAA,KAAK,EAAE6C,OAAO,CAAC7C,KAJV;AAKLN,QAAAA,MAAM,EAAEmD,OAAO,CAACnD,MALX;AAMLsD,QAAAA,OAAO,EAAE,SAASA,OAAT,GAAmB;AAC1B,iBAAOpC,YAAY,CAACiC,OAAO,CAACnD,MAAR,GAAiB,CAAC,CAAlB,GAAsB,CAAvB,CAAnB;AACD;AARI,OAAP;AAUD,KAXqB,CAAtB;AAYA,QAAIuD,cAAc,GAAG,CAAC,QAAD,EAAW,cAAX,EAA2BL,GAA3B,CAA+B,UAAUM,OAAV,EAAmB;AACrE,aAAO;AACLJ,QAAAA,IAAI,EAAEI,OAAO,KAAK,QAAZ,GAAuB,aAAa7K,KAAK,CAAC0K,aAAN,CAAoBhB,KAAK,CAACW,MAA1B,EAAkC;AAC1EjB,UAAAA,KAAK,EAAEG;AADmE,SAAlC,CAApC,GAED,aAAavJ,KAAK,CAAC0K,aAAN,CAAoBhB,KAAK,CAACS,YAA1B,EAAwC;AACxDf,UAAAA,KAAK,EAAEG;AADiD,SAAxC,CAHb;AAMLuB,QAAAA,SAAS,EAAElH,MAAM,CAAC;AAChBmH,UAAAA,EAAE,EAAEF,OAAO,KAAK,QAAZ,GAAuB,gBAAvB,GAA0C,kBAD9B;AAEhBlI,UAAAA,QAAQ,EAAEA;AAFM,SAAD,CANZ;AAULgI,QAAAA,OAAO,EAAE,SAASA,OAAT,GAAmB;AAC1B,cAAI3F,MAAM,IAAI,IAAIvD,WAAd,IAA6BoJ,OAAO,KAAK,QAA7C,EAAuD;AACrD,mBAAOxC,MAAM,EAAb;AACD;;AAED,cAAIrD,MAAM,IAAIvD,WAAV,IAAyBoJ,OAAO,KAAK,cAAzC,EAAyD;AACvD,mBAAOvC,OAAO,EAAd;AACD;;AAED,iBAAOnB,SAAP;AACD,SApBI;AAqBL6D,QAAAA,KAAK,EAAE;AArBF,OAAP;AAuBD,KAxBoB,CAArB;AAyBA,QAAIC,WAAW,GAAG;AAChBnH,MAAAA,QAAQ,EAAEwG,eADM;AAEhBtF,MAAAA,MAAM,EAAE4F,cAFQ;AAGhBZ,MAAAA,UAAU,EAAE;AACVS,QAAAA,IAAI,EAAE,aAAazK,KAAK,CAAC0K,aAAN,CAAoBhB,KAAK,CAACK,UAA1B,EAAsC;AACvDX,UAAAA,KAAK,EAAEG;AADgD,SAAtC,CADT;AAIVuB,QAAAA,SAAS,EAAElH,MAAM,CAAC;AAChBmH,UAAAA,EAAE,EAAE,kBADY;AAEhBpI,UAAAA,QAAQ,EAAEA;AAFM,SAAD,CAJP;AAQVgI,QAAAA,OAAO,EAAElC;AARC,OAHI;AAahBZ,MAAAA,KAAK,EAAE;AACL4C,QAAAA,IAAI,EAAE,aAAazK,KAAK,CAAC0K,aAAN,CAAoBhB,KAAK,CAACO,KAA1B,EAAiC;AAClDb,UAAAA,KAAK,EAAEG;AAD2C,SAAjC,CADd;AAILuB,QAAAA,SAAS,EAAElH,MAAM,CAAC;AAChBmH,UAAAA,EAAE,EAAE,mBADY;AAEhBpI,UAAAA,QAAQ,EAAEA;AAFM,SAAD,CAJZ;AAQLgI,QAAAA,OAAO,EAAEjG,OAAO,GAAGmD,KAAH,GAAWD;AARtB,OAbS;AAuBhBA,MAAAA,IAAI,EAAE;AACJ6C,QAAAA,IAAI,EAAE,aAAazK,KAAK,CAAC0K,aAAN,CAAoBhB,KAAK,CAACQ,IAA1B,EAAgC;AACjDd,UAAAA,KAAK,EAAEG;AAD0C,SAAhC,CADf;AAIJuB,QAAAA,SAAS,EAAElH,MAAM,CAAC;AAChBmH,UAAAA,EAAE,EAAE,kBADY;AAEhBpI,UAAAA,QAAQ,EAAEA;AAFM,SAAD,CAJb;AAQJgI,QAAAA,OAAO,EAAEjG,OAAO,GAAGmD,KAAH,GAAWD;AARvB;AAvBU,KAAlB;AAkCA,QAAIsD,iBAAiB,GAAG,EAAxB;AACA,KAACjC,eAAe,GAAG1G,QAAQ,CAAC2D,KAA5B,KAAsC,IAAtC,GAA6C,KAAK,CAAlD,GAAsD+C,eAAe,CAACsB,GAAhB,CAAoB,UAAUY,IAAV,EAAgB;AACxF,UAAIA,IAAI,KAAK,QAAb,EAAuB;AACrBP,QAAAA,cAAc,CAACL,GAAf,CAAmB,UAAUM,OAAV,EAAmB;AACpC,iBAAOK,iBAAiB,CAACxD,IAAlB,CAAuBmD,OAAvB,CAAP;AACD,SAFD;AAGA,eAAO1D,SAAP;AACD;;AAED,UAAI,OAAOgE,IAAP,KAAgB,QAApB,EAA8B,OAAOD,iBAAiB,CAACxD,IAAlB,CAAuBuD,WAAW,CAACE,IAAD,CAAlC,CAAP;AAC9B,aAAOD,iBAAiB,CAACxD,IAAlB,CAAuByD,IAAvB,CAAP;AACD,KAVqD,CAAtD;AAWAnC,IAAAA,eAAe,GAAG,aAAahJ,KAAK,CAAC0K,aAAN,CAAoBrJ,mBAApB,EAAyC;AACtE6H,MAAAA,IAAI,EAAEA,IADgE;AAEtE7B,MAAAA,MAAM,EAAE,CAAClC,SAAD,IAAc5C,QAAQ,CAAC4D,QAAT,KAAsB,OAApC,IAA+C+C,IAAI,IAAI5D,WAFO;AAGtE8F,MAAAA,MAAM,EAAE,SAASA,MAAT,GAAkB;AACxB,YAAI,CAACnK,aAAa,CAAC6E,YAAY,CAACO,OAAd,CAAlB,EAA0Cd,cAAc,CAAC,KAAD,CAAd;AAC3C;AALqE,KAAzC,EAM5B,aAAavF,KAAK,CAAC0K,aAAN,CAAoB/J,GAApB,EAAyB;AACvC0K,MAAAA,SAAS,EAAE,KAD4B;AAEvCC,MAAAA,KAAK,EAAE,QAFgC;AAGvCC,MAAAA,OAAO,EAAE,SAH8B;AAIvCpC,MAAAA,UAAU,EAAEA;AAJ2B,KAAzB,EAKb,aAAanJ,KAAK,CAAC0K,aAAN,CAAoB9J,MAApB,EAA4B;AAC1C6J,MAAAA,IAAI,EAAE/F,OAAO,GAAG,aAAa1E,KAAK,CAAC0K,aAAN,CAAoBhB,KAAK,CAACO,KAA1B,EAAiC;AAC5Db,QAAAA,KAAK,EAAEG,SADqD;AAE5DuB,QAAAA,SAAS,EAAElH,MAAM,CAAC;AAChBmH,UAAAA,EAAE,EAAE,mBADY;AAEhBpI,UAAAA,QAAQ,EAAEA;AAFM,SAAD;AAF2C,OAAjC,CAAhB,GAMR,aAAa3C,KAAK,CAAC0K,aAAN,CAAoBhB,KAAK,CAACQ,IAA1B,EAAgC;AAChDd,QAAAA,KAAK,EAAEG,SADyC;AAEhDuB,QAAAA,SAAS,EAAElH,MAAM,CAAC;AAChBmH,UAAAA,EAAE,EAAE,kBADY;AAEhBpI,UAAAA,QAAQ,EAAEA;AAFM,SAAD;AAF+B,OAAhC,CAPwB;AAc1C6I,MAAAA,cAAc,EAAE,YAd0B;AAe1Cb,MAAAA,OAAO,EAAEjG,OAAO,GAAGmD,KAAH,GAAWD;AAfe,KAA5B,CALA,EAqBZ,aAAa5H,KAAK,CAAC0K,aAAN,CAAoB/J,GAApB,EAAyB;AACxC0K,MAAAA,SAAS,EAAE,KAD6B;AAExCC,MAAAA,KAAK,EAAE,QAFiC;AAGxCG,MAAAA,IAAI,EAAE;AAHkC,KAAzB,EAId,aAAazL,KAAK,CAAC0K,aAAN,CAAoB/J,GAApB,EAAyB;AACvC8K,MAAAA,IAAI,EAAE;AADiC,KAAzB,EAEb,aAAazL,KAAK,CAAC0K,aAAN,CAAoB3J,KAApB,EAA2B,IAA3B,EAAiC,aAAaf,KAAK,CAAC0K,aAAN,CAAoB5J,KAApB,EAA2B;AACvF,oBAAc8C,MAAM,CAAC;AACnBmH,QAAAA,EAAE,EAAE,qBADe;AAEnBpI,QAAAA,QAAQ,EAAEA;AAFS,OAAD,CADmE;AAKvFwG,MAAAA,UAAU,EAAED,IAAI,GAAGxF,KAAK,CAAC0C,KAAN,CAAYsF,QAAZ,IAAwBhI,KAAK,CAAC0C,KAAN,CAAYsF,QAAZ,CAAqBlE,KAA7C,IAAsD9D,KAAK,CAAC0C,KAAN,CAAYsF,QAAZ,CAAqBlE,KAArB,CAA2B4B,KAAjF,IAA0F,QAA7F,GAAwGjC,SALjC;AAMvFwE,MAAAA,IAAI,EAAE,MANiF;AAOvFC,MAAAA,SAAS,EAAE,OAP4E;AAQvFC,MAAAA,MAAM,EAAE,CAAC;AACPC,QAAAA,KAAK,EAAEvH,gBAAgB,IAAI;AADpB,OAAD;AAR+E,KAA3B,CAA9C,EAWZ,aAAavE,KAAK,CAAC0K,aAAN,CAAoBpJ,mBAApB,EAAyC;AACxD,oBAAcsC,MAAM,CAAC;AACnBmH,QAAAA,EAAE,EAAE,gBADe;AAEnBpI,QAAAA,QAAQ,EAAEA;AAFS,OAAD,CADoC;AAKxDT,MAAAA,GAAG,EAAE6D,WALmD;AAMxDgG,MAAAA,QAAQ,EAAE,CAN8C;AAOxDC,MAAAA,IAAI,EAAE,QAPkD;AAQxDF,MAAAA,KAAK,EAAEjH,SAAS,GAAGhD,IAAI,CAACC,KAAL,CAAW+C,SAAS,GAAGT,QAAZ,GAAuB,GAAlC,CAAH,GAA4C+C,SARJ;AASxD8E,MAAAA,WAAW,EAAEnE,KAT2C;AAUxDoE,MAAAA,YAAY,EAAE,SAASA,YAAT,GAAwB;AACpC,eAAOpH,YAAY,CAACqC,SAAD,CAAnB;AACD,OAZuD;AAaxDwD,MAAAA,OAAO,EAAEvC;AAb+C,KAAzC,CAXD,CAFA,CAJC,EA+BX,aAAapI,KAAK,CAAC0K,aAAN,CAAoB/J,GAApB,EAAyB;AAC1CwL,MAAAA,GAAG,EAAE;AACHC,QAAAA,UAAU,EAAE;AADT;AADqC,KAAzB,EAIhB,aAAapM,KAAK,CAAC0K,aAAN,CAAoB1J,IAApB,EAA0B;AACxC0B,MAAAA,MAAM,EAAE;AADgC,KAA1B,EAEb+G,aAFa,CAJG,CA/BF,CArBD,EA0DK,aAAazJ,KAAK,CAAC0K,aAAN,CAAoB7J,IAApB,EAA0B;AAC1D4J,MAAAA,IAAI,EAAE,aAAazK,KAAK,CAAC0K,aAAN,CAAoBhB,KAAK,CAACG,SAA1B,EAAqC;AACtDT,QAAAA,KAAK,EAAEG;AAD+C,OAArC,CADuC;AAI1D8C,MAAAA,SAAS,EAAE;AACTC,QAAAA,MAAM,EAAE,KADC;AAETC,QAAAA,KAAK,EAAE;AAFE,OAJ+C;AAQ1DC,MAAAA,cAAc,EAAErD,UAR0C;AAS1DxG,MAAAA,QAAQ,EAAE;AACR8J,QAAAA,QAAQ,EAAE7I,MAAM,CAAC;AACfmH,UAAAA,EAAE,EAAE,gBADW;AAEfpI,UAAAA,QAAQ,EAAEA;AAFK,SAAD,CADR;AAKR+J,QAAAA,SAAS,EAAE9I,MAAM,CAAC;AAChBmH,UAAAA,EAAE,EAAE,iBADY;AAEhBpI,UAAAA,QAAQ,EAAEA;AAFM,SAAD;AALT,OATgD;AAmB1DuD,MAAAA,KAAK,EAAE,GAAGyG,MAAH,CAAUzB,iBAAV;AAnBmD,KAA1B,CA1DlB,CANe,CAA/B;AAqFD;;AAED,MAAI0B,mBAAJ;;AAEA,MAAI,CAACrK,QAAQ,IAAI,IAAZ,GAAmB,KAAK,CAAxB,GAA4BA,QAAQ,CAAC4D,QAAtC,MAAoD,MAAxD,EAAgE;AAC9DyG,IAAAA,mBAAmB,GAAG;AACpBC,MAAAA,YAAY,EAAE,SAASA,YAAT,GAAwB;AACpC,eAAOtH,cAAc,CAAC,IAAD,CAArB;AACD,OAHmB;AAIpB0G,MAAAA,WAAW,EAAE,SAASA,WAAT,GAAuB;AAClC,eAAO1G,cAAc,CAAC,IAAD,CAArB;AACD,OANmB;AAOpBuH,MAAAA,YAAY,EAAE,SAASA,YAAT,GAAwB;AACpC,eAAOvH,cAAc,CAAC,IAAD,CAArB;AACD;AATmB,KAAtB;AAWD;;AAED,MAAIwH,KAAJ;;AAEA,MAAItJ,IAAI,CAACuJ,GAAL,KAAa,SAAb,IAA0B,CAACzK,QAAQ,IAAI,IAAZ,GAAmB,KAAK,CAAxB,GAA4BA,QAAQ,CAAC4D,QAAtC,MAAoD,MAAlF,EAA0F;AACxF;AACA;AACA,QAAIP,KAAJ,EAAW;AACTmH,MAAAA,KAAK,GAAG;AACNnH,QAAAA,KAAK,EAAEA;AADD,OAAR;AAGD,KAJD,MAIO,IAAIH,MAAJ,EAAY;AACjBsH,MAAAA,KAAK,GAAG;AACNtH,QAAAA,MAAM,EAAEA;AADF,OAAR;AAGD;AACF;;AAED,SAAO,aAAazF,KAAK,CAAC0K,aAAN,CAAoBtJ,oBAApB,EAA0CtC,QAAQ,CAAC;AACrEoD,IAAAA,GAAG,EAAE4D;AADgE,GAAD,EAEnE8G,mBAFmE,EAE9C;AACtBzK,IAAAA,SAAS,EAAEA,SADW;AAEtBK,IAAAA,QAAQ,EAAEA,QAFY;AAGtBE,IAAAA,MAAM,EAAEA,MAHc;AAItBqK,IAAAA,KAAK,EAAEA;AAJe,GAF8C,CAAlD,EAOhB,aAAa/M,KAAK,CAAC0K,aAAN,CAAoBvJ,WAApB,EAAiCrC,QAAQ,CAAC,EAAD,EAAK2E,IAAL,EAAW;AACnEvB,IAAAA,GAAG,EAAE8D,QAD8D;AAEnElD,IAAAA,gBAAgB,EAAE,SAASA,gBAAT,CAA0BiF,KAA1B,EAAiC;AACjD,UAAI3B,KAAK,GAAGJ,QAAQ,CAACK,OAArB;AACAhC,MAAAA,WAAW,CAAC+B,KAAK,CAAChC,QAAP,CAAX;AACAI,MAAAA,mBAAmB,CAAC4B,KAAK,CAACnC,WAAN,GAAoBmC,KAAK,CAAChC,QAA1B,GAAqC,GAAtC,CAAnB;AACA,UAAIvB,iBAAJ,EAAuBA,iBAAiB,CAACkF,KAAD,CAAjB;AACxB,KAPkE;AAQnE/E,IAAAA,OAAO,EAAE,SAASA,OAAT,CAAiB+E,KAAjB,EAAwB;AAC/BpD,MAAAA,UAAU,CAAC,KAAD,CAAV;AACA,UAAI5B,QAAJ,EAAcA,QAAQ,CAACgF,KAAD,CAAR;AACf,KAXkE;AAYnE7E,IAAAA,OAAO,EAAE,SAASA,OAAT,CAAiB6E,KAAjB,EAAwB;AAC/BpD,MAAAA,UAAU,CAAC,KAAD,CAAV;AACA,UAAI1B,QAAJ,EAAcA,QAAQ,CAAC8E,KAAD,CAAR;AACf,KAfkE;AAgBnE3E,IAAAA,MAAM,EAAE,SAASA,MAAT,CAAgB2E,KAAhB,EAAuB;AAC7BpD,MAAAA,UAAU,CAAC,IAAD,CAAV;AACAS,MAAAA,YAAY,CAAC,IAAD,CAAZ;AACA,UAAIjC,OAAJ,EAAaA,OAAO,CAAC4E,KAAD,CAAP;AACd,KApBkE;AAqBnEzE,IAAAA,YAAY,EAAE,SAASA,YAAT,CAAsByE,KAAtB,EAA6B;AACzC,UAAI3B,KAAK,GAAGJ,QAAQ,CAACK,OAArB;AACAnC,MAAAA,cAAc,CAACkC,KAAK,CAACnC,WAAP,CAAd;AACAO,MAAAA,mBAAmB,CAAC4B,KAAK,CAACnC,WAAN,GAAoBmC,KAAK,CAAChC,QAA1B,GAAqC,GAAtC,CAAnB;AACA,UAAIf,aAAJ,EAAmBA,aAAa,CAAC0E,KAAD,CAAb;AACpB,KA1BkE;AA2BnEvE,IAAAA,cAAc,EAAE,SAASA,cAAT,CAAwBuE,KAAxB,EAA+B;AAC7C9C,MAAAA,SAAS,CAACe,QAAQ,CAACK,OAAT,CAAiBrB,MAAlB,CAAT;AACA,UAAIzB,eAAJ,EAAqBA,eAAe,CAACwE,KAAD,CAAf;AACtB,KA9BkE;AA+BnE3F,IAAAA,QAAQ,EAAEA,QAAQ,IAAI,KA/B6C;AAgCnEK,IAAAA,IAAI,EAAEA,IAAI,IAAI;AAhCqD,GAAX,CAAzC,EAiCbJ,QAjCa,CAPG,EAwCL2G,eAxCK,CAApB;AAyCD,CApfkC,CAAnC;AAqfAhH,KAAK,CAACtB,YAAN,GAAqB,EAArB;AACAsB,KAAK,CAACiL,WAAN,GAAoB,OAApB;AACAjL,KAAK,CAACkL,SAAN,GAAkB1L,cAAlB;AACA,SAASQ,KAAT","sourcesContent":["var _excluded = [\"alignSelf\", \"autoPlay\", \"children\", \"controls\", \"gridArea\", \"loop\", \"margin\", \"messages\", \"mute\", \"onDurationChange\", \"onEnded\", \"onPause\", \"onPlay\", \"onTimeUpdate\", \"onVolumeChange\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React, { forwardRef, useCallback, useContext, useEffect, useMemo, useRef, useState } from 'react';\nimport { ThemeContext } from 'styled-components';\nimport { useLayoutEffect } from '../../utils/use-isomorphic-layout-effect';\nimport { defaultProps } from '../../default-props';\nimport { Box } from '../Box';\nimport { Button } from '../Button';\nimport { Menu } from '../Menu';\nimport { Meter } from '../Meter';\nimport { Stack } from '../Stack';\nimport { Text } from '../Text';\nimport { containsFocus, useForwardedRef } from '../../utils';\nimport { StyledVideo, StyledVideoContainer, StyledVideoControls, StyledVideoScrubber } from './StyledVideo';\nimport { MessageContext } from '../../contexts/MessageContext';\nimport { VideoPropTypes } from './propTypes'; // Split the volume control into 6 segments. Empirically determined.\n\nvar VOLUME_STEP = 0.166667;\n\nvar formatTime = function formatTime(time) {\n  var minutes = Math.round(time / 60);\n\n  if (minutes < 10) {\n    minutes = \"0\" + minutes;\n  }\n\n  var seconds = Math.round(time) % 60;\n\n  if (seconds < 10) {\n    seconds = \"0\" + seconds;\n  }\n\n  return minutes + \":\" + seconds;\n};\n\nvar Video = /*#__PURE__*/forwardRef(function (_ref, ref) {\n  var alignSelf = _ref.alignSelf,\n      autoPlay = _ref.autoPlay,\n      children = _ref.children,\n      controlsProp = _ref.controls,\n      gridArea = _ref.gridArea,\n      loop = _ref.loop,\n      margin = _ref.margin,\n      messages = _ref.messages,\n      mute = _ref.mute,\n      _onDurationChange = _ref.onDurationChange,\n      _onEnded = _ref.onEnded,\n      _onPause = _ref.onPause,\n      _onPlay = _ref.onPlay,\n      _onTimeUpdate = _ref.onTimeUpdate,\n      _onVolumeChange = _ref.onVolumeChange,\n      rest = _objectWithoutPropertiesLoose(_ref, _excluded);\n\n  var theme = useContext(ThemeContext) || defaultProps.theme;\n\n  var _useContext = useContext(MessageContext),\n      format = _useContext.format;\n\n  var _useState = useState([]),\n      captions = _useState[0],\n      setCaptions = _useState[1];\n\n  var _useState2 = useState(),\n      currentTime = _useState2[0],\n      setCurrentTime = _useState2[1];\n\n  var _useState3 = useState(),\n      duration = _useState3[0],\n      setDuration = _useState3[1];\n\n  var _useState4 = useState(),\n      percentagePlayed = _useState4[0],\n      setPercentagePlayed = _useState4[1];\n\n  var _useState5 = useState(false),\n      playing = _useState5[0],\n      setPlaying = _useState5[1];\n\n  var _useState6 = useState(),\n      scrubTime = _useState6[0],\n      setScrubTime = _useState6[1];\n\n  var _useState7 = useState(),\n      volume = _useState7[0],\n      setVolume = _useState7[1];\n\n  var _useState8 = useState(false),\n      hasPlayed = _useState8[0],\n      setHasPlayed = _useState8[1];\n\n  var _useState9 = useState(),\n      interacting = _useState9[0],\n      setInteracting = _useState9[1];\n\n  var _useState10 = useState(),\n      height = _useState10[0],\n      setHeight = _useState10[1];\n\n  var _useState11 = useState(),\n      width = _useState11[0],\n      setWidth = _useState11[1];\n\n  var containerRef = useRef();\n  var scrubberRef = useRef();\n  var videoRef = useForwardedRef(ref);\n  var controls = useMemo(function () {\n    var result;\n\n    if (typeof controlsProp === 'string' || typeof controlsProp === 'boolean') {\n      result = {\n        items: ['volume', 'fullScreen'],\n        position: controlsProp\n      };\n    } else {\n      result = {\n        items: (controlsProp == null ? void 0 : controlsProp.items) || ['volume', 'fullScreen'],\n        position: (controlsProp == null ? void 0 : controlsProp.position) || 'over'\n      };\n    }\n\n    return result;\n  }, [controlsProp]); // mute if needed\n\n  useEffect(function () {\n    var video = videoRef.current;\n    if (video && mute) video.muted = true;\n  }, [mute, videoRef]); // when the video is first rendered, set state from it where needed\n\n  useEffect(function () {\n    var video = videoRef.current;\n\n    if (video) {\n      // hide all captioning to start with\n      var textTracks = video.textTracks;\n\n      for (var i = 0; i < textTracks.length; i += 1) {\n        textTracks[i].mode = 'hidden';\n      }\n\n      setCurrentTime(video.currentTime);\n      setPercentagePlayed(video.currentTime / video.duration * 100);\n      setVolume(videoRef.current.volume);\n    }\n  }, [videoRef]); // turn off interacting after a while\n\n  useEffect(function () {\n    var timer = setTimeout(function () {\n      if (interacting && !containsFocus(containerRef.current)) {\n        setInteracting(false);\n      }\n    }, 3000);\n    return function () {\n      return clearTimeout(timer);\n    };\n  }, [interacting]);\n  useLayoutEffect(function () {\n    var video = videoRef.current;\n\n    if (video) {\n      if (video.videoHeight) {\n        // set the size based on the video aspect ratio\n        var rect = video.getBoundingClientRect();\n        var ratio = rect.width / rect.height;\n        var videoRatio = video.videoWidth / video.videoHeight;\n\n        if (videoRatio > ratio) {\n          var nextHeight = rect.width / videoRatio;\n\n          if (nextHeight !== height) {\n            setHeight(nextHeight);\n            setWidth(undefined);\n          }\n        } else {\n          var nextWidth = rect.height * videoRatio;\n\n          if (nextWidth !== width) {\n            setHeight(undefined);\n            setWidth(nextWidth);\n          }\n        }\n      } // remember the state of the text tracks for subsequent rendering\n\n\n      var textTracks = video.textTracks;\n\n      if (textTracks.length > 0) {\n        if (textTracks.length === 1) {\n          var active = textTracks[0].mode === 'showing';\n\n          if (!captions || !captions[0] || captions[0].active !== active) {\n            setCaptions([{\n              active: active\n            }]);\n          }\n        } else {\n          var nextCaptions = [];\n          var set = false;\n\n          for (var i = 0; i < textTracks.length; i += 1) {\n            var track = textTracks[i];\n\n            var _active = track.mode === 'showing';\n\n            nextCaptions.push({\n              label: track.label,\n              active: _active\n            });\n\n            if (!captions || !captions[i] || captions[i].active !== _active) {\n              set = true;\n            }\n          }\n\n          if (set) {\n            setCaptions(nextCaptions);\n          }\n        }\n      }\n    }\n  }, [captions, height, videoRef, width]);\n  var play = useCallback(function () {\n    return videoRef.current.play();\n  }, [videoRef]);\n  var pause = useCallback(function () {\n    return videoRef.current.pause();\n  }, [videoRef]);\n  var scrub = useCallback(function (event) {\n    if (scrubberRef.current) {\n      var scrubberRect = scrubberRef.current.getBoundingClientRect();\n      var percent = (event.clientX - scrubberRect.left) / scrubberRect.width;\n      setScrubTime(duration * percent);\n    }\n  }, [duration]);\n  var seek = useCallback(function (event) {\n    if (scrubberRef.current) {\n      var scrubberRect = scrubberRef.current.getBoundingClientRect();\n      var percent = (event.clientX - scrubberRect.left) / scrubberRect.width;\n      if (duration) videoRef.current.currentTime = duration * percent;\n    }\n  }, [duration, videoRef]);\n  var louder = useCallback(function () {\n    videoRef.current.volume += VOLUME_STEP;\n  }, [videoRef]);\n  var quieter = useCallback(function () {\n    videoRef.current.volume -= VOLUME_STEP;\n  }, [videoRef]);\n\n  var showCaptions = function showCaptions(index) {\n    var textTracks = videoRef.current.textTracks;\n\n    for (var i = 0; i < textTracks.length; i += 1) {\n      textTracks[i].mode = i === index ? 'showing' : 'hidden';\n    }\n  };\n\n  var fullscreen = useCallback(function () {\n    var video = videoRef.current;\n\n    if (video.requestFullscreen) {\n      video.requestFullscreen();\n    } else if (video.msRequestFullscreen) {\n      video.msRequestFullscreen();\n    } else if (video.mozRequestFullScreen) {\n      video.mozRequestFullScreen();\n    } else if (video.webkitRequestFullscreen) {\n      video.webkitRequestFullscreen();\n    } else {\n      console.warn(\"This browser doesn't support fullscreen.\");\n    }\n  }, [videoRef]);\n  var controlsElement;\n\n  if (controls != null && controls.position) {\n    var _controls$items;\n\n    var over = controls.position === 'over';\n    var background = over ? theme.video.controls && theme.video.controls.background || {\n      color: 'background-back',\n      opacity: 'strong',\n      dark: true\n    } : undefined;\n    var iconColor = over && (theme.video.icons.color || 'text');\n    var formattedTime = formatTime(scrubTime || currentTime || duration);\n    var Icons = {\n      ClosedCaption: theme.video.icons.closedCaption,\n      Configure: theme.video.icons.configure,\n      FullScreen: theme.video.icons.fullScreen,\n      Pause: theme.video.icons.pause,\n      Play: theme.video.icons.play,\n      ReduceVolume: theme.video.icons.reduceVolume,\n      Volume: theme.video.icons.volume\n    };\n    var captionControls = captions.map(function (caption) {\n      return {\n        icon: caption.label ? undefined : /*#__PURE__*/React.createElement(Icons.ClosedCaption, {\n          color: iconColor\n        }),\n        label: caption.label,\n        active: caption.active,\n        onClick: function onClick() {\n          return showCaptions(caption.active ? -1 : 0);\n        }\n      };\n    });\n    var volumeControls = ['volume', 'reduceVolume'].map(function (control) {\n      return {\n        icon: control === 'volume' ? /*#__PURE__*/React.createElement(Icons.Volume, {\n          color: iconColor\n        }) : /*#__PURE__*/React.createElement(Icons.ReduceVolume, {\n          color: iconColor\n        }),\n        a11yTitle: format({\n          id: control === 'volume' ? 'video.volumeUp' : 'video.volumeDown',\n          messages: messages\n        }),\n        onClick: function onClick() {\n          if (volume <= 1 - VOLUME_STEP && control === 'volume') {\n            return louder();\n          }\n\n          if (volume >= VOLUME_STEP && control === 'reduceVolume') {\n            return quieter();\n          }\n\n          return undefined;\n        },\n        close: false\n      };\n    });\n    var buttonProps = {\n      captions: captionControls,\n      volume: volumeControls,\n      fullScreen: {\n        icon: /*#__PURE__*/React.createElement(Icons.FullScreen, {\n          color: iconColor\n        }),\n        a11yTitle: format({\n          id: 'video.fullScreen',\n          messages: messages\n        }),\n        onClick: fullscreen\n      },\n      pause: {\n        icon: /*#__PURE__*/React.createElement(Icons.Pause, {\n          color: iconColor\n        }),\n        a11yTitle: format({\n          id: 'video.pauseButton',\n          messages: messages\n        }),\n        onClick: playing ? pause : play\n      },\n      play: {\n        icon: /*#__PURE__*/React.createElement(Icons.Play, {\n          color: iconColor\n        }),\n        a11yTitle: format({\n          id: 'video.playButton',\n          messages: messages\n        }),\n        onClick: playing ? pause : play\n      }\n    };\n    var controlsMenuItems = [];\n    (_controls$items = controls.items) == null ? void 0 : _controls$items.map(function (item) {\n      if (item === 'volume') {\n        volumeControls.map(function (control) {\n          return controlsMenuItems.push(control);\n        });\n        return undefined;\n      }\n\n      if (typeof item === 'string') return controlsMenuItems.push(buttonProps[item]);\n      return controlsMenuItems.push(item);\n    });\n    controlsElement = /*#__PURE__*/React.createElement(StyledVideoControls, {\n      over: over,\n      active: !hasPlayed || controls.position === 'below' || over && interacting,\n      onBlur: function onBlur() {\n        if (!containsFocus(containerRef.current)) setInteracting(false);\n      }\n    }, /*#__PURE__*/React.createElement(Box, {\n      direction: \"row\",\n      align: \"center\",\n      justify: \"between\",\n      background: background\n    }, /*#__PURE__*/React.createElement(Button, {\n      icon: playing ? /*#__PURE__*/React.createElement(Icons.Pause, {\n        color: iconColor,\n        a11yTitle: format({\n          id: 'video.pauseButton',\n          messages: messages\n        })\n      }) : /*#__PURE__*/React.createElement(Icons.Play, {\n        color: iconColor,\n        a11yTitle: format({\n          id: 'video.playButton',\n          messages: messages\n        })\n      }),\n      hoverIndicator: \"background\",\n      onClick: playing ? pause : play\n    }), /*#__PURE__*/React.createElement(Box, {\n      direction: \"row\",\n      align: \"center\",\n      flex: true\n    }, /*#__PURE__*/React.createElement(Box, {\n      flex: true\n    }, /*#__PURE__*/React.createElement(Stack, null, /*#__PURE__*/React.createElement(Meter, {\n      \"aria-label\": format({\n        id: 'video.progressMeter',\n        messages: messages\n      }),\n      background: over ? theme.video.scrubber && theme.video.scrubber.track && theme.video.scrubber.track.color || 'dark-3' : undefined,\n      size: \"full\",\n      thickness: \"small\",\n      values: [{\n        value: percentagePlayed || 0\n      }]\n    }), /*#__PURE__*/React.createElement(StyledVideoScrubber, {\n      \"aria-label\": format({\n        id: 'video.scrubber',\n        messages: messages\n      }),\n      ref: scrubberRef,\n      tabIndex: 0,\n      role: \"button\",\n      value: scrubTime ? Math.round(scrubTime / duration * 100) : undefined,\n      onMouseMove: scrub,\n      onMouseLeave: function onMouseLeave() {\n        return setScrubTime(undefined);\n      },\n      onClick: seek\n    }))), /*#__PURE__*/React.createElement(Box, {\n      pad: {\n        horizontal: 'small'\n      }\n    }, /*#__PURE__*/React.createElement(Text, {\n      margin: \"none\"\n    }, formattedTime))), /*#__PURE__*/React.createElement(Menu, {\n      icon: /*#__PURE__*/React.createElement(Icons.Configure, {\n        color: iconColor\n      }),\n      dropAlign: {\n        bottom: 'top',\n        right: 'right'\n      },\n      dropBackground: background,\n      messages: {\n        openMenu: format({\n          id: 'video.openMenu',\n          messages: messages\n        }),\n        closeMenu: format({\n          id: 'video.closeMenu',\n          messages: messages\n        })\n      },\n      items: [].concat(controlsMenuItems)\n    })));\n  }\n\n  var mouseEventListeners;\n\n  if ((controls == null ? void 0 : controls.position) === 'over') {\n    mouseEventListeners = {\n      onMouseEnter: function onMouseEnter() {\n        return setInteracting(true);\n      },\n      onMouseMove: function onMouseMove() {\n        return setInteracting(true);\n      },\n      onTouchStart: function onTouchStart() {\n        return setInteracting(true);\n      }\n    };\n  }\n\n  var style;\n\n  if (rest.fit === 'contain' && (controls == null ? void 0 : controls.position) === 'over') {\n    // constrain the size to fit the aspect ratio so the controls\n    // overlap correctly\n    if (width) {\n      style = {\n        width: width\n      };\n    } else if (height) {\n      style = {\n        height: height\n      };\n    }\n  }\n\n  return /*#__PURE__*/React.createElement(StyledVideoContainer, _extends({\n    ref: containerRef\n  }, mouseEventListeners, {\n    alignSelf: alignSelf,\n    gridArea: gridArea,\n    margin: margin,\n    style: style\n  }), /*#__PURE__*/React.createElement(StyledVideo, _extends({}, rest, {\n    ref: videoRef,\n    onDurationChange: function onDurationChange(event) {\n      var video = videoRef.current;\n      setDuration(video.duration);\n      setPercentagePlayed(video.currentTime / video.duration * 100);\n      if (_onDurationChange) _onDurationChange(event);\n    },\n    onEnded: function onEnded(event) {\n      setPlaying(false);\n      if (_onEnded) _onEnded(event);\n    },\n    onPause: function onPause(event) {\n      setPlaying(false);\n      if (_onPause) _onPause(event);\n    },\n    onPlay: function onPlay(event) {\n      setPlaying(true);\n      setHasPlayed(true);\n      if (_onPlay) _onPlay(event);\n    },\n    onTimeUpdate: function onTimeUpdate(event) {\n      var video = videoRef.current;\n      setCurrentTime(video.currentTime);\n      setPercentagePlayed(video.currentTime / video.duration * 100);\n      if (_onTimeUpdate) _onTimeUpdate(event);\n    },\n    onVolumeChange: function onVolumeChange(event) {\n      setVolume(videoRef.current.volume);\n      if (_onVolumeChange) _onVolumeChange(event);\n    },\n    autoPlay: autoPlay || false,\n    loop: loop || false\n  }), children), controlsElement);\n});\nVideo.defaultProps = {};\nVideo.displayName = 'Video';\nVideo.propTypes = VideoPropTypes;\nexport { Video };"]},"metadata":{},"sourceType":"module"}